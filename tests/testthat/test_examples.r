test_that("Artifical ccs errors are denoised properly.", {
    
  #PACBB5941-16
  toy_example1 = list(
  	'ACAATGTATTTCATCCTAGGAATATGATCAGGAATATTAGGAATAATATTAAGAATATTAATTCGAATTGAACTAGCACAACCAGGACCATTAATAAGAAATGACCAAATTTATAATGTAATTGTTACATCTCATGCATTCATTATAATTTTTATGGTAATACCAATTATAATCGGAGGATTCGGAAATTGATTAGTACCATTAATAATTGGAGCACCAGATATAGCATTCCCACGAATAAATAATATAAGATTTTGACTTCTTCCACCCTCACTTACATTGTTAATTTCAAGATCAATAGTAGAAATAGGACCAGGAACAGGATGAACACTATATCCACCGCTATCGTCAAATATTGCACATTCGGGAGGAAGTGTAGACTTAAGAATTTTTTCATTACACTTAGCCGGTGTATCATCAATCCTAGGAGCAATTAACTTTATTACAACAATTCTAAATATACGAACACTAGGAATATCATTAGACCGAACCCCCTTATTCGTATGATCAGTAATAATTACTGCAATTTTACTACTTCTATCTCTACCAGTACTAGCTGGAGCAATCACGATA',
  	'ACAATGTATTTCATCCTAGGAATATGATCAGGAATATTAGGAATAATATTAAGAATATTAATTCGAATTGAACTAGCACAACCAGGACCATTAATAAGAAATGACCAAATTTATAATGTAATTGTTACATCTCATGCATTCATTATAATTTTTTTTATGGTAATACCAATTATAATCGGAGGATTCGGAAATTGATTAGTACCATTAATAATTGGAGCACCAGATATAGCATTCCCACGAATAAATAATATAAGATTTTGATTCTTCCACCCTCACTTACATTGTTAATTTCAAGATCAATAGTAGAAATAGGACCAGGAACAGGATGAACACTATATCCACCGCTATCGTCAAATATTGCACATTCGGGAGGAAGTGTAGACTTAAGAATTTTTTTCATTACACTTAGCCGGTGTATCATCAATCCTAGGAGCAATTAACTTTATTACAACAATTCTAAATATACGAACACTAGGAATATCATTAGACCGAACCCCCTTATTCGTATGATCAGTAATAATTACTGCAATTTTACTACTTCTATCTCTACCAGTACTAGCTGGAGCAATCACGATACTGCTAACAGACCGAAATATTAATACATCATTTTTTGATCCCTCAGGAGGAGGAGAC',
  	'TCCTAGGAATATGATCAGGAATATTAGGAATAATATTAAGAATATTAATTCGAATTGAACTAGCACAACCAGGACCATTAATAAGAAATGACCAAATTTATATGTAATTGTTACATCTCATGCATTCATTATAATTTTTTTTTATGGTAATACCAATTATAATCGGAGGATTCGGAAATTGATTAGTACCATTAATAATTGGAGCACCAGATTAGCATTCCCACGAATAAATAATATAAGATTTTGACTTCTTCCACCCTCACTTACATTGTTAATTTCAAGATCAATAGTAGAAATAGGACCAGGAACAGGATGAACACTATATCCACCGCTATCGTCAAATATTGCACATTCGGGAGGAAGTGTAGACTTAAGAATTTTTTCATTACACTTAGCCGGTGTATCATCAATCCTAGGAGCAATTAACTTTATTACAACAATTCTAAATATACGAACACTAGGAATATCATTAGACCGAACCCCCTTATTCGTATGATCAGTAATAATTACTGCAATTTTACTACTTCTATCTCTACCAGTACTAGCTGGAGCAATCACGATACTGCTAACAGACCGAAATATTAATACATCATTTTTTGATCCCTCAGGAGGAGGAGAC',
  	'ACAATGTATTTCATCCTAGGAATATGATCAGGAATATTAGGAATAATATTAAGAATATTAATTCGAATTGAACTAGCACAACCAGGACCATTAATAAGAAATGACCAAATTTATAATGTAATTGTTACATCTCATGCATTCATTATAATTTTTTTATGGTAATACCAATTATAATCGGAGGATTCGGAAATTGATTAGTACCATTAATAATTGGAGCACCAGATATAGCATTCCCACGAATAAATAATATAAGATTTTGACTTCTTCCACCCTCACTTACATTGTTAATTTCAAGATCAATAGTAGAAATAGGACCAGCGAACAGGATGAACACTATATCCACCGCTATCGTCAAATATTGCACATTCGGGAGGAAGTGTAGACTTAAGAATTTTTTCATTACACTTAGCCGGTGTATCATCAATCCTAGGAGCAATTAACTTTATTACAACAATTCTAAATATACGAACACTAGGAATATCATTAGACCGAACCCCCTTATTCGTATGATCAGTAATAATTACTGCAATTTTACTACTTCTATCTCTACCAGTACTAGCTGGAGCAATCACGATACTGCTAACAGACCGAAATATTAATACATCATTTTTTGATCCCTCAGGAGGAGGAGAC',
  	'ACAATGTATTTCATCCTAGGAATATGATCAGGAATATTAGGAATAATATTAAGAATATTAATTCGAATTGAACTAGCACAACCAGGACCATTAATAAGAAATGACCAAATTTATAATGTAATTGTTACATCTCATGCATTCATTATAATTTTTTTTTTATGGTAATACCAATTATAATCGGAGGATTCGGAAATTGATTAGTACCATTAATAATTGGAGCACCAGATATAGCATTCCCACGAATAAATAATATAAGATTTTGACTTCTTCCACCCTCACTTACATTGTTAATTTCAAGATCAATAGTAGAAATAGGACCAGGAACAGGATGAACACTATATCCACCGCTATCGTCAAATATTGCACATTCGGGAGGAAGTGTAGACTTAAGAATTTTTTCATTACACTTAGCCGGTGTATCATCAATCCTAGGAGCAATTAACTTTATTACAACAATTCTAAATATACGAACACTAGGAATATCATTAGACCGAACCCCCTTATTCGTATGATCAGTAATAATTACTGCAATTTTACTACTTCTATCTCTACCAGTACTAGCTGGAGCAATCACGATACTGCTAACAGACCGAAATATTAATACATCATTTTTTTGATCCCTCAGGAGGAGGAGAC'
  	)
  
  toy1_expected = "ACAATGTATTTCATCCTAGGAATATGATCAGGAATATTAGGAATAATATTAAGAATATTAATTCGAATTGAACTAGCACAACCAGGACCATTAATAAGAAATGACCAAATTTATAATGTAATTGTTACATCTCATGCATTCATTATAATTTTTTTTATGGTAATACCAATTATAATCGGAGGATTCGGAAATTGATTAGTACCATTAATAATTGGAGCACCAGATATAGCATTCCCACGAATAAATAATATAAGATTTTGACTTCTTCCACCCTCACTTACATTGTTAATTTCAAGATCAATAGTAGAAATAGGACCAGGAACAGGATGAACACTATATCCACCGCTATCGTCAAATATTGCACATTCGGGAGGAAGTGTAGACTTAAGAATTTTTTCATTACACTTAGCCGGTGTATCATCAATCCTAGGAGCAATTAACTTTATTACAACAATTCTAAATATACGAACACTAGGAATATCATTAGACCGAACCCCCTTATTCGTATGATCAGTAATAATTACTGCAATTTTACTACTTCTATCTCTACCAGTACTAGCTGGAGCAATCACGATACTGCTAACAGACCGAAATATTAATACATCATTTTTTGATCCCTCAGGAGGAGGAGA"
  
  test_toy1 = build_ccs(x =toy_example1,
  						id = "PACBB5941-16", 
  						order = "hemiptera")	
  
  test_toy1_out = denoise(test_toy1, 
                      		ambig_char = "N",
                      		censor_length = 3,
                      		aa_check = FALSE, 
                      		to_file = FALSE)
  
  
  expect_equal(test_toy1_out$consensus, toy1_expected)
    
  #PACBB858-16
  #567 length sequence and it has the starting point that seems to be causing the issue with alignment
  toy_example2 = list(
  	'TTTATTTTTGGTGCATGATCTAGAATAGTAGGAACTTCCTTAAGAATATTAATTCGTGCAGAATTAGGAACCCCTAATGCATTAATTGGAGATGATCAAATTTATAATGTAATTGTAACAGCCCATGCATTCATTATAATTTTTCTTTATAGTAATACCTATTATAATTGGAGGATTTGGTAATTGATTAGTACCACTGATATTAAGAGCCCCTGATATAGCTTTTCCACGATTAAATAATATAAGATTTTGACTTTTACCTCCATCTTTAACATTATTGTTAACTAGAAGTTTAGTAGAAAGAGGAACCGGTACAGGATGAACAGTTTACCCCCCACTGTCATCTACATTAAGGCATTCCGGAGCATCTGTAGATTTATCTATTTTTTCTTTGCATTTAGCAGGGATTTCCTCTATTCTAGGAGCAGTAAATTTTATTTCAACAATTATTAATATACGGGCCCCAGGAATAACTTTTGATAAAATACCTTTATTTGTGTGATCAGTATTAATTACTGCAGTATTACTATTATTATCTTTACCAGTTCTAGCTGGAGCAATTACTATA',
  	'TTTTATTTTTGGTGCATGATCTAGAATAGTAGGAACTTCCTTAAGAATATTAATTCGTGCAGAATTAGGAACCCCCTAATGCATTAATTGGAGATGATCAAATTTATAATGTAATTGTAACAGCCCATGCATTCATTATAATTTTCTTTATAGTAATACCTATTATAATTGGAGGATTTGGTAATTGATTAGTACCACTGATATTAAGAGCCCCTGATATAGCTTTTCCACGATTAAATAATATAAGATTTTGACTTTTACCTCCATCTTTAACATTATTGTTAACTAGAAGTTTTAGTAGAAAGAGGAACCGGTACAGGATGAACAGTTTACCCCCCACTGTCATCTACATTAAGGCATTCCGGAGCATCTGTAGATTTATCTATTTTTTCTTTGCATTTAGCAGGGATTTCCTCTATTCTAGGAGCAGTAAATTTTATTTCAACAATTATTAATATACGGGCCCCAGGAATAACTTTTGATAAAATACCTTTATTTGTGTGATCAGTATTAATTACTGCAGTATTACTATTATTATCTTTACCAGTTCTAGCTGGAGCAATTACTATA',
  	'TTTTTGGTGCATGATCTAGAATAGTAGGAACTTCCTTAAGAATATTAATTCGTGCAGAATTAGGAACCCCTAATGCATTAATTGGAGATGATCAAATTTATAATGTAATTGTAACAGCCCATGCATTCATTATAATTTTCTTTATAGTAATACCTATTATAATTGGAGGATTTGGTAATTGATTAGTACCACTGATATTAAGAGCCCCTGATATAGCTTTCCACGATTAAATAATATAAGATTTTGACTTTTACCTCCATCTTTAACATTATTGTTAACTAGAAGTTTAGTAGAAAGAGGAACCGGTACAGGATGAACAGTTTACCCCCCACTGTCATCTACATTAAGGCATTCCGGAGCATCTGTAGATTTATCTATTTTTTCTTTGCATTTAGCAGGGATTTCCTCTATTCTAGGAGCAGTAAATTTTATTTCAACAATTATTAATATACGGGCCCCAGGAATAACTTTTGATAAAATACCTTTATTTGTGTGATCAGTATTAATTACTGCAGTATTACTATTATTATCTTTACCAGTTCTAGCTGGAGCAATTACTATA',
  	'TTTATTTTTGGTGCATGATCTAGAATAGTAGGAACTTCCTTAAGAATATTAATTCGTGCAGAATTAGGAACCCCTAATGCATTAATTGGAGATGATCAAATTTATAATGTAATTGTAACAGCCCATGCATTCATTATAATTTTCTTTATAGTAATACCTATTATAATTGGAGGATTTGTAATTGATTAGTACCACTGATATTAAGAGCCCCTGATATAGCTTTTCCACGATTAAATAATATAAGATTTTGACTTTTACCTCCATCTTTAACATTATTGTTAACTAGAAGTTTAGTAGAAAGAGGAACCGGTACAGGATGAACAGTTTACCCCCCACTGTCATCTACATTAAGGCATTCCGGAGCATCTGTAGATTTATCTATTTTTTCTTTGCATTTAGCAGGGATTTCCTCTATTCTAGGAGCAGTAAATTTTATTTCAACAATTATTAATATACGGGCCCCAGGAATAACTTTTGATAAAATACCTTTATTTGTGTGATCAGTATTAATTACTGCAGTATTACTATTATTATCTTTACCAGTTCTAGCTGGAGCAATTACTATA',
  	'TTTATTTTTGGTGCATGATCTAGAATAGTAGGAACTTCCTTAAGAATATTAATTCGTGCAGAATTAGGAACCCCTAATGCATTAATTGGAGATGATCAAATTTATAATGTAATTGTAACAGCCCATGCATTCATTATAATTTTCTTTATAGTAATACCTATTATAATTGGAGGATTTTGGTAATTGATTAGTACCACTGATATTAAGAGCCCCTGATATAGCTTTTCCACGATTAAATAATATAAGATTTTGACTTTTACCTCCATCTTTAACATTATTGTTAACTAGAAGTTTAGTAGAAAGAGGAACCGGTACAGGATGAACAGTTTACCCCCCACTGTCATCTACATTAAGGCATTCCGGAGCATCTGTAGATTTATCTATTTTTTCTTTGCATTTAGCAGGGATTTCCTCTATTCTAGGAGCAGTAAATTTTATTTCAACAATTATTAATATACGGGCCCCAGGAATAACTTTTGATAAAATACCTTTATTTGTGTGATCAGTATTAATTACTGCAGTATTACTATTATTATCTTTACCAGTTCTAGCTGGAGCAATTACTATA'
  	)
  
  toy2_expected = "NNNNNNNNTTTTATTTTTGGTGCATGATCTAGAATAGTAGGAACTTCCTTAAGAATATTAATTCGTGCAGAATTAGGAACCCCTAATGCATTAATTGGAGATGATCAAATTTATAATGTAATTGTAACAGCCCATGCATTCATTATAATTTTCTTTATAGTAATACCTATTATAATTGGAGGATTTGGTAATTGATTAGTACCACTGATATTAAGAGCCCCTGATATAGCTTTTCCACGATTAAATAATATAAGATTTTGACTTTTACCTCCATCTTTAACATTATTGTTAACTAGAAGTTTAGTAGAAAGAGGAACCGGTACAGGATGAACAGTTTACCCCCCACTGTCATCTACATTAAGGCATTCCGGAGCATCTGTAGATTTATCTATTTTTTCTTTGCATTTAGCAGGGATTTCCTCTATTCTAGGAGCAGTAAATTTTATTTCAACAATTATTAATATACGGGCCCCAGGAATAACTTTTGATAAAATACCTTTATTTGTGTGATCAGTATTAATTACTGCAGTATTACTATTATTATCTTTACCAGTTCTAGCTGGAG"
  
  
  
  test_toy2 = build_ccs(x =toy_example2,
  						id = "toy_example2-short_and_messy", 
  						order = "diptera")	
  
  test_toy2_out = denoise(test_toy2, 
                      		ambig_char = "N",
                      		censor_length = 3,
                      		aa_check = FALSE, 
                      		to_file = FALSE)
  
  expect_equal(test_toy2_out$consensus, toy2_expected)


  
  #PACBB009-16
  toy_example3 = list(
    'AAGTTTATTAATTCGAGCAGAATTAGGTAATCCAGGTTCTTTAATTGGAGATGATCAAATTTATAATACTATTGTTACAGCTCATGCTTTTTTATTATAATTTTTTTTATAGTTATGCCAATTATAATTGGAGGTTTTGGTAATTGACTAGTTCCTTTAATACTAGGAGCCCCTGATATAGCTTTCCCCCGAATAAATAATATAAGTTTCTGACTTTTACCTCCCTCTCTTACCTTATTAATTTCAAGAAGAATTGTAGAAAATGGTGCAGGAACTGGATGAACAGTTTACCCTCCTCTTTCTTCTAATATCGCTCATAGAGGAAGATCAGTAGATTTAGCTATTTTTTCTTTACATTTAGCTGGTATTTCATCAATTTTAGGGGCTATTAATTTTATTACTACAATTATTAACATACGATTAAATAGACTAATATTTGATCAAATACCTTTATTCGTATGAGCTGTAGGGATTACTGCTTTTCTTTTATTACTCTCTTTACCAGTTTTAGCAGGAGCTATTACTATACTTTTAACTGAT',
    'ACACTTTACTTTATTTTTGGTATTTGAGCAGGTATATTAGGGACTTCATTAAGTTTATTAATTCGAGCAGAATTAGGTAATCCAGGTTCTTTAATTGGAGATGATCAAATTTATAATACTATTGTTACAGGCTCATGCTTTTATTATAATTTTTTTTATAGTTATGCCAATTATAATTGGAGGTTTTGGTAATTGACTAGTTCCTTTAATACTAGGAGCCCCTGATATAGCTTTCCCCCGAATAAATAATATAAGTTTCTGACTTTTACCTCCCTCTCTTACCTTATTAATTTCAAGAAGAATTGTAGAAAATGGTGCAGGAACTGGATGAACAGTTTACCCTCCTCTTTCTCTAATATCGCTCATAGAGGAAGATCAGTAGATTTAGCTATTTTTTCTTTACATTTAGCTGGTATTTCATCAATTTTAGGGGCTATTAATTTTATTACTACAATTATTAACATACGATTAAATAGACTAATATTTGATCAAATACCTTTATTCGTATGAGCTGTAGGGATTACTGCTTTTCTTTTATTACTCTCTTTACCAGTTTTAGCAGGAGCTATTACTATACTTTTAACTGAT',
    'ACACTTTACTTTATTTTTGGTATTTGAGCAGGTATATTAGGGACTTCATTAAGTTTATTAATTCGAGCAGAAATTAGGTAATCCAGGTTCTTTAATTGGAGATGATCAAATTTATAATACTATTGTTACAGCTCATGCTTTTATTATAATTTTTTTTATAGTTATGCCAATTATAATTGGAGGTTTTGGTAATTGACTAGTTCCTTTAATACTAGGAGCCCCTGATATAGCTTTCCCCCGAATAAATAATATAAGTTTCTGACTTTTACCTCCCTCTCTTACCTTATTAATTTCAAGAAGAATTGTAGAAAATGGTGCAGGAACTGGATGAACAGTTTACCCTCCTCTTTCTTCTAATATCGCTCATAGAGGAAGATCAGTAGATTTAGCTATTTTTTCTTTACATTTAGCTGGTATTTCATCAATTTTAGGGGCTATTAATTTTATTACTACAATTATTAACATACGATTAAATAGACTAATATTTGATCAAATACCTTTATTCGTATGAGCTGTAGGGATTACTGCTTTTCTTTTA'	
  )
  
  toy3_expected = "ACACTTTACTTTATTTTTGGTATTTGAGCAGGTATATTAGGGACTTCATTAAGTTTATTAATTCGAGCAGAATTAGGTAATCCAGGTTCTTTAATTGGAGATGATCAAATTTATAATACTATTGTTACAGCTCATGCTTTTATTATAATTTTTTTTATAGTTATGCCAATTATAATTGGAGGTTTTGGTAATTGACTAGTTCCTTTAATACTAGGAGCCCCTGATATAGCTTTCCCCCGAATAAATAATATAAGTTTCTGACTTTTACCTCCCTCTCTTACCTTATTAATTTCAAGAAGAATTGTAGAAAATGGTGCAGGAACTGGATGAACAGTTTACCCTCCTCTTTCTTCTAATATCGCTCATAGAGGAAGATCAGTAGATTTAGCTATTTTTTCTTTACATTTAGCTGGTATTTCATCAATTTTAGGGGCTATTAATTTTATTACTACAATTATTAACATACGATTAAATAGACTAATATTTGATCAAATACCTTTATTCGTATGAGCTGTAGGGATTACTGCTTTTCTTTTATTACTCTCTTTACCAGTTTTAGCAGGAGCTATTACTATACTTTTAA"
  
  test_toy3 = build_ccs(x =toy_example3,
                        id = "toy_example3-long_and_messy", 
                        order = "lepidoptera")	
  
  test_toy3_out = denoise(test_toy3, 
                          ambig_char = "N",
                          censor_length = 3,
                          aa_check = FALSE, 
                          to_file = FALSE)
  
  
  expect_equal(test_toy3_out$consensus, toy3_expected)

})



# 
# 
# 
# 
# ####################
# #looking at the steps in the process to nail down where things go wrong
# ####################
# for(x in 1:3){
#   print(paste(test_toy3_out$adjusted_sequences[[x]], collapse = ''))
# }
# 
# for(x in 1:3){
#   print(paste(test_toy3_out$data$paths[[x]], collapse = ''))
# }
# 
# #description of problem below:
# # 1. The detection logic has failed here... 5 matching 1s and then another run of 0s
# #   a. simple fix - move the frame scope out to ~10bp.... there are always going to be issues with this
# #   b. ^a. is now resolved as shown with the path for the first ccs read... but we now have the phantom ----- occuring!
# #     this is further evidence that the dashes are due to a bad application of the censorship that isn't adding the leading dash number to the correction.
# #  c. RESOLVED!
# 'AAGTTTATTAATTCGAGCAGAATTAGGTAATCCAGGTTCTTTAATTGGAGATGATCAAATTTATAATACTATTGTTACAGCTCATGCTTTTTTATTATAATTTTTTTTATAGTTATGCCAATTATAATTGGAGGTTTTGGTAATTGACTAGTTCCTTTAATACTAGGAGCCCCTGATATAGCTTTCCCCCGAATAAATAATATAAGTTTCTGACTTTTACCTCCCTCTCTTACCTTATTAATTTCAAGAAGAATTGTAGAAAATGGTGCAGGAACTGGATGAACAGTTTACCCTCCTCTTTCTTCTAATATCGCTCATAGAGGAAGATCAGTAGATTTAGCTATTTTTTCTTTACATTTAGCTGGTATTTCATCAATTTTAGGGGCTATTAATTTTATTACTACAATTATTAACATACGATTAAATAGACTAATATTTGATCAAATACCTTTATTCGTATGAGCTGTAGGGATTACTGCTTTTCTTTTATTACTCTCTTTACCAGTTTTAGCAGGAGCTATTACTATACTTTTAACTGAT',
# "00000000000000000000000000000000000000000111110000000001111111111111111111111111111111111111111111111111111111111111111111111111111111111111221111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111110000000000000000000000000000000000001000000000110000000000000000001000"
# "00000000000000000000000000000000000000000111110000000001111111111111111111111111111111111111111111111111111111111111111111111111111111111112211111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111110000000000000000000000000000000000001000000000110000000000000000001000"
# "-----------------------------------------aagtt"
#                                          'AAGTT         TATTAATTCGAGCAGAATTAGGTAATCCAGGTTCTTTAATTGGAGATGATCAAATTTATAATACTATTGTTACAGCTCATGCTTTTTTATTATAATTTTTTTTATAGTTATGCCAATTATAATTGGAGGTTTTGGTAATTGACTAGTTCCTTTAATACTAGGAGCCCCTGATATAGCTTTCCCCCGAATAAATAATATAAGTTTCTGACTTTTACCTCCCTCTCTTACCTTATTAATTTCAAGAAGAATTGTAGAAAATGGTGCAGGAACTGGATGAACAGTTTACCCTCCTCTTTCTTCTAATATCGCTCATAGAGGAAGATCAGTAGATTTAGCTATTTTTTCTTTACATTTAGCTGGTATTTCATCAATTTTAGGGGCTATTAATTTTATTACTACAATTATTAACATACGATTAAATAGACTAATATTTGATCAAATACCTTTATTCGTATGAGCTGTAGGGATTACTGCTTTTCTTTTATTACTCTCTTTACCAGTTTTAGCAGGAGCTATTACTATACTTTTAACTGAT',
# "-------------------------------------------------------tattaattcgagcagaattaggtaatc------ctttaattggagatgatcaaatttataatactattgttacagctcatgcttttattataattttttttatagttatgccaattataattggaggttttggtaattgactagttcctttaatactaggagcccctgatatagctttcccccgaataaataatataagtttctgacttttacctccctctcttaccttattaatttcaagaagaattgtagaaaatggtgcaggaactggatgaacagtttaccctcctctttcttctaatatcgctcatagaggaagatcagtagatttagctattttttctttacatttagctggtatttcatcaattttaggggctattaattttattactacaattattaacatacgattaaatagactaatatttgatcaaatacctttattcgtatgagctgtagggattactgcttttcttttattactctctttaccagttttagcaggagctattactatacttttaa"
# "-------------------------------------------------------tattaattcgagcagaattaggtaatccaggttctttaattggagatgatcaaatttataatactattgttacagctcatg------ttataattttttttatagttatgccaattataattggaggttttggtaattgactagttcctttaatactaggagcccctgatatagctttcccccgaataaataatataagtttctgacttttacctccctctcttaccttattaatttcaagaagaattgtagaaaatggtgcaggaactggatgaacagtttaccctcctctttcttctaatatcgctcatagaggaagatcagtagatttagctattttttctttacatttagctggtatttcatcaattttaggggctattaattttattactacaattattaacatacgattaaatagactaatatttgatcaaatacctttattcgtatgagctgtagggattactgcttttcttttattactctctttaccagttttagcaggagctattactatacttttaa"
# 
# 'ACACTTTACTTTATTTTTGGTATTTGAGCAGGTATATTAGGGACTTCATTAAGTTTATTAATTCGAGCAGAATTAGGTAATCCAGGTTCTTTAATTGGAGATGATCAAATTTATAATACTATTGTTACAGGCTCATGCTTTTATTATAATTTTTTTTATAGTTATGCCAATTATAATTGGAGGTTTTGGTAATTGACTAGTTCCTTTAATACTAGGAGCCCCTGATATAGCTTTCCCCCGAATAAATAATATAAGTTTCTGACTTTTACCTCCCTCTCTTACCTTATTAATTTCAAGAAGAATTGTAGAAAATGGTGCAGGAACTGGATGAACAGTTTACCCTCCTCTTTCTCTAATATCGCTCATAGAGGAAGATCAGTAGATTTAGCTATTTTTTCTTTACATTTAGCTGGTATTTCATCAATTTTAGGGGCTATTAATTTTATTACTACAATTATTAACATACGATTAAATAGACTAATATTTGATCAAATACCTTTATTCGTATGAGCTGTAGGGATTACTGCTTTTCTTTTATTACTCTCTTTACCAGTTTTAGCAGGAGCTATTACTATACTTTTAACTGAT',
# "1111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111211111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111110111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111110000000000000000000000000000000000001000000000110000000000000000001000"
# "acactttactttatttttggtatttgagcaggtatattagggacttcattaagtttattaattcgagcagaattaggtaatccaggttctttaattggagatgatcaaatttataatactattgttac------tgcttttattataattttttttatagttatgccaattataattggaggttttggtaattgactagttcctttaatactaggagcccctgatatagctttcccccgaataaataatataagtttctgacttttacctccctctcttaccttattaatttcaagaagaattgtagaaaatggtgcaggaactggatgaacagtttaccctcctctt-------atatcgctcatagaggaagatcagtagatttagctattttttctttacatttagctggtatttcatcaattttaggggctattaattttattactacaattattaacatacgattaaatagactaatatttgatcaaatacctttattcgtatgagctgtagggattactgcttttcttttattactctctttaccagttttagcaggagctattactatacttttaa"
# 
# "acactttactttatttttggtatttgagcaggtatattagggacttcattaagtttattaattcgagcagaattaggtaatccaggttctttaattggagatgatcaaatttataatactattgtta------atgcttttattataattttttttatagttatgccaattataattggaggttttggtaattgactagttcctttaatactaggagcccctgatatagctttcccccgaataaataatataagtttctgacttttacctccctctcttaccttattaatttcaagaagaattgtagaaaatggtgcaggaactggatgaacagtttaccctcctctt-------atatcgctcatagaggaagatcagtagatttagctattttttctttacatttagctggtatttcatcaattttaggggctattaattttattactacaattattaacatacgattaaatagactaatatttgatcaaatacctttattcgtatgagctgtagggattactgcttttcttttattactctctttaccagttttagcaggagctattactatacttttaa"
# 
# 'ACACTTTACTTTATTTTTGGTATTTGAGCAGGTATATTAGGGACTTCATTAAGTTTATTAATTCGAGCAGAAATTAGGTAATCCAGGTTCTTTAATTGGAGATGATCAAATTTATAATACTATTGTTACAGCTCATGCTTTTATTATAATTTTTTTTATAGTTATGCCAATTATAATTGGAGGTTTTGGTAATTGACTAGTTCCTTTAATACTAGGAGCCCCTGATATAGCTTTCCCCCGAATAAATAATATAAGTTTCTGACTTTTACCTCCCTCTCTTACCTTATTAATTTCAAGAAGAATTGTAGAAAATGGTGCAGGAACTGGATGAACAGTTTACCCTCCTCTTTCTTCTAATATCGCTCATAGAGGAAGATCAGTAGATTTAGCTATTTTTTCTTTACATTTAGCTGGTATTTCATCAATTTTAGGGGCTATTAATTTTATTACTACAATTATTAACATACGATTAAATAGACTAATATTTGATCAAATACCTTTATTCGTATGAGCTGTAGGGATTACTGCTTTTCTTTTA'	
# "1111111111111111111111111111111111111111111111111111111111111111111111112111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111110000000000000000000000000000000000000000000000000000000000000000000000000000001110000000000000001111000000000000000000000111100011111"
# "acactttactttatttttggtatttgagcaggtatattagggacttcattaagtttattaattcgagcag------gtaatccaggttctttaattggagatgatcaaatttataatactattgttacagctcatgcttttattataattttttttatagttatgccaattataattggaggttttggtaattgactagttcctttaatactaggagcccctgatatagctttcccccgaataaataatataagtttctgacttttacctccctctcttaccttattaatttcaagaagaattgtagaaaatggtgcaggaactggatgaacagtttaccctcctctttcttctaatatcgctcatagaggaagatcagtagatttagctattttttctttacatttagctggtatttcatcaattttaggggctattaattttattactacaattattaacatacgattaaatagactaatatttgatcaaatacctttattcgtatgagctgtagggat"
# 
# "acactttactttatttttggtatttgagcaggtatattagggacttcattaagtttattaattcgagcag------gtaatccaggttctttaattggagatgatcaaatttataatactattgttacagctcatgcttttattataattttttttatagttatgccaattataattggaggttttggtaattgactagttcctttaatactaggagcccctgatatagctttcccccgaataaataatataagtttctgacttttacctccctctcttaccttattaatttcaagaagaattgtagaaaatggtgcaggaactggatgaacagtttaccctcctctttcttctaatatcgctcatagaggaagatcagtagatttagctattttttctttacatttagctggtatttcatcaattttaggggctattaattttattactacaattattaacatacgattaaatagactaatatttgatcaaatacctttattcgtatgagctgtagggat"
# 
# 
# "ACACTTTACTTTATTTTTGGTATTTGAGCAGGTATATTAGGGACTTCATTAAGTTTATTAATTCGAGCAGAATTAGGTAATCCAGGTTCTTTAATTGGAGATGATCAAATTTATAATACTATTGTTACAGCTCATGCTTTTATTATAATTTTTTTTATAGTTATGCCAATTATAATTGGAGGTTTTGGTAATTGACTAGTTCCTTTAATACTAGGAGCCCCTGATATAGCTTTCCCCCGAATAAATAATATAAGTTTCTGACTTTTACCTCCCTCTCTTACCTTATTAATTTCAAGAAGAATTGTAGAAAATGGTGCAGGAACTGGATGAACAGTTTACCCTCCTCTTTCTTCTAATATCGCTCATAGAGGAAGATCAGTAGATTTAGCTATTTTTTCTTTACATTTAGCTGGTATTTCATCAATTTTAGGGGCTATTAATTTTATTACTACAATTATTAACATACGATTAAATAGACTAATATTTGATCAAATACCTTTATTCGTATGAGCTGTAGGGATTACTGCTTTTCTTTTATTACTCTCTTTACCAGTTTTAGCAGGAGCTATTACTATACTTTTAA"
# #new version doesnt affect consensus
# "ACACTTTACTTTATTTTTGGTATTTGAGCAGGTATATTAGGGACTTCATTAAGTTTATTAATTCGAGCAGAATTAGGTAATCCAGGTTCTTTAATTGGAGATGATCAAATTTATAATACTATTGTTACAGCTCATGCTTTTATTATAATTTTTTTTATAGTTATGCCAATTATAATTGGAGGTTTTGGTAATTGACTAGTTCCTTTAATACTAGGAGCCCCTGATATAGCTTTCCCCCGAATAAATAATATAAGTTTCTGACTTTTACCTCCCTCTCTTACCTTATTAATTTCAAGAAGAATTGTAGAAAATGGTGCAGGAACTGGATGAACAGTTTACCCTCCTCTTTCTTCTAATATCGCTCATAGAGGAAGATCAGTAGATTTAGCTATTTTTTCTTTACATTTAGCTGGTATTTCATCAATTTTAGGGGCTATTAATTTTATTACTACAATTATTAACATACGATTAAATAGACTAATATTTGATCAAATACCTTTATTCGTATGAGCTGTAGGGATTACTGCTTTTCTTTTATTACTCTCTTTACCAGTTTTAGCAGGAGCTATTACTATACTTTTAA"
# "ACACTTTACTTTATTTTTGGTATTTGAGCAGGTATATTAGGGACTTCATTAAGTTTATTAATTCGAGCAGAATTAGGTAATCCAGGTTCTTTAATTGGAGATGATCAAATTTATAATACTATTGTTACAGCTCATGCTTTTATTATAATTTTTTTTATAGTTATGCCAATTATAATTGGAGGTTTTGGTAATTGACTAGTTCCTTTAATACTAGGAGCCCCTGATATAGCTTTCCCCCGAATAAATAATATAAGTTTCTGACTTTTACCTCCCTCTCTTACCTTATTAATTTCAAGAAGAATTGTAGAAAATGGTGCAGGAACTGGATGAACAGTTTACCCTCCTCTTTCTTCTAATATCGCTCATAGAGGAAGATCAGTAGATTTAGCTATTTTTTCTTTACATTTAGCTGGTATTTCATCAATTTTAGGGGCTATTAATTTTATTACTACAATTATTAACATACGATTAAATAGACTAATATTTGATCAAATACCTTTATTCGTATGAGCTGTAGGGATTACTGCTTTTCTTTTATTACTCTCTTTACCAGTTTTAGCAGGAGCTATTACTATACTTTTAA"
# 
# test_toy3_out$consensus
# 
# #PACBB6586-16
# toy_example4 = list(
# 	"GCCGGAATAGTAGGGACATCTATAAGTTTACTAATTCGATCAGAATTAGGGATGCCTGGGACATTAATTGGTAATGACCAAATTTATAATGTTATTGTTACAGCTCATGCATTTATTATAATTTTTTTTTATAGTTATACCAATTATAATTGGGGGATTTGGTAATTGATTAGTCCCTTTAATATTGGGGGCCCCTGATATAGCTTTCCCTCGAATAAATAATATAAGATTTTGACTTTTACCTCCTTCTTTAACTTTACTTCTTATAAGAAGAATGGTAGAAAGAGGGGCAGGGACAGGATGGACAGTTTACCCCCCCTTTATCAGCGAATATTGCCCATGGAGGTTCTTCGGTAGATTTAGCTATTTTTAGTTTACACTTAGCAGGTATTTCATCTATCCTCGGTGCAGTTAATTTTATTACAACTGTAATTAACATACGACCTGAAGGAATAACCTTAGATCGAATACCGCTTTTTGTTTGAGCAGTAGCAATTACAGCTTTACTTTTACTTTTATCCCTGCCTGTTTTAGCA",
# 	"GCCGGAATAGTAGGGACATCTATAAGTTTACTAATTCGATCAGAATTAGGGATGCCTGGGACATTAATTGGTAATGACCAAATTTATAATGTTATTGTTACAGCTCATGCATTTATTATAATTTTTTTATAGTTATACCAATTATAATTGGGGGGATTTGGTAATTGATTAGTCCCTTTAATATTGGGGGCCCCTGATATAGCTTTCCCTCGAATAAATAATATAAGATTTTGACTTTTACCTCCTTCTTTAACTTTACTTCTTATAAGAAGAATGGTAGAAAGAGGGGCAGGGACAGGATGGACAGTTTACCCCCCCCTTTATCAGCGAATATTGCCCATGGAGGTTCTTCGGTAGATTTAGCTATTTTTAGTTTACACTTAGCAGGTATTTCATCTATCCTCGGTGCAGTTAATTTTATTACAACTGTAATTAACATACGACCTGAAGGAATAACCTTAGATCGAATACCGCTTTTTGTTTGAGCAGTAGCAATTACAGCTTTACTTTTACTTTTATCCCTGCCTGTTTTAGCA",	
# 	"GCCGGAATAGTAGGGACATCTATAAGTTTACTAATTCGATCAGAATTAGGGATGCCTGGGACATTAATTGGTAATGACCAAATTTATAATGTTATTGTTACAGCTCATGCATTTATTATAATTTTTTTTTTATAGTTATACCAATTATAATTGGGGATTTGGTAATTGATTAGTCCCTTTAATATTGGGGGCCCCTGATATAGCTTTCCCTCGAATAAATAATATAAGATTTTGACTTTTACCTCCTTCTTTAACTTTACTTCTTATAAGAAGAATGGTAGAAAGAGGGGCAGGGACAGGATGGACAGTTTACCCCCCTTTATCAGCGAATATTGCCCATGGAGGTTCTTCGGTAGATTTAGCTATTTTTAGTTTACACTTAGCAGGTATTTCATCTATCCTCGGTGCAGTTAATTTTATTACAACTGTAATTAACATACGACCTGAAGGAATAACCTTAGATCGAATACCGCTTTTTGTTTGAGCAGTAGCAATTACAGCTTTACTTTTACTTTTATCCCTGCCTGTTTTAGCA"
# 	)
# 
# 
# #description of problem below:
# # 2. there are 3 sequences, each of which has a mask applied in the wrong location at ~bp 130. no deviance in paths indicating masks should be here
#     # the problem goes away when censor length == 0. 
#     # then the adjusted sequences look proper, so issue is occuring in the censorship part of the adj_seq function... 
#     # corrections are being placed in wrong spot. appears they're all about 20 too low, likely due to the dashes being added and not
#     # accounting for this number
# 
#                            "GCCGGAATAGTAGGGACATCTATAAGTTTACTAATTCGATCAGAATTAGGGATGCCTGGGACATTAATTGGTAATGACCAAATTTATAATGTTATTGTTACAGCTCATGCATTTATTATAATTTTTTTTTATAGTTATACCAATTATAATTGGGGGATTTGGTAATTGATTAGTCCCTTTAATATTGGGGGCCCCTGATATAGCTTTCCCTCGAATAAATAATATAAGATTTTGACTTTTACCTCCTTCTTTAACTTTACTTCTTATAAGAAGAATGGTAGAAAGAGGGGCAGGGACAGGATGGACAGTTTACCCCCCCTTTATCAGCGAATATTGCCCATGGAGGTTCTTCGGTAGATTTAGCTATTTTTAGTTTACACTTAGCAGGTATTTCATCTATCCTCGGTGCAGTTAATTTTATTACAACTGTAATTAACATACGACCTGAAGGAATAACCTTAGATCGAATACCGCTTTTTGTTTGAGCAGTAGCAATTACAGCTTTACTTTTACTTTTATCCCTGCCTGTTTTAGCA",
# "00000000000000000000000000011111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111211111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111121111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111000000000000000000000000000000000000000110000000000000000000001110000000001000000000000000000000000"
#                            "GCCGGAATAGTAGGGACATCTATAAGTTTACTAATTCGATCAGAATTAGGGATGCCTGGGACATTAATTGGTAATGACCAAATTTATAATGTTATTGTTACAGCTCATGCATTTATTATAATTTTTTTATAGTTATACCAATTATAATTGGGGGGATTTGGTAATTGATTAGTCCCTTTAATATTGGGGGCCCCTGATATAGCTTTCCCTCGAATAAATAATATAAGATTTTGACTTTTACCTCCTTCTTTAACTTTACTTCTTATAAGAAGAATGGTAGAAAGAGGGGCAGGGACAGGATGGACAGTTTACCCCCCCCTTTATCAGCGAATATTGCCCATGGAGGTTCTTCGGTAGATTTAGCTATTTTTAGTTTACACTTAGCAGGTATTTCATCTATCCTCGGTGCAGTTAATTTTATTACAACTGTAATTAACATACGACCTGAAGGAATAACCTTAGATCGAATACCGCTTTTTGTTTGAGCAGTAGCAATTACAGCTTTACTTTTACTTTTATCCCTGCCTGTTTTAGCA",	
# "000000000000000000000000000111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111110111111111111111111111111112111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111221111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111000000000000000000000000000000000000000110000000000000000000001110000000001000000000000000000000000"
#                            "GCCGGAATAGTAGGGACATCTATAAGTTTACTAATTCGATCAGAATTAGGGATGCCTGGGACATTAATTGGTAATGACCAAATTTATAATGTTATTGTTACAGCTCATGCATTTATTATAATTTTTTTTTTATAGTTATACCAATTATAATTGGGGATTTGGTAATTGATTAGTCCCTTTAATATTGGGGGCCCCTGATATAGCTTTCCCTCGAATAAATAATATAAGATTTTGACTTTTACCTCCTTCTTTAACTTTACTTCTTATAAGAAGAATGGTAGAAAGAGGGGCAGGGACAGGATGGACAGTTTACCCCCCTTTATCAGCGAATATTGCCCATGGAGGTTCTTCGGTAGATTTAGCTATTTTTAGTTTACACTTAGCAGGTATTTCATCTATCCTCGGTGCAGTTAATTTTATTACAACTGTAATTAACATACGACCTGAAGGAATAACCTTAGATCGAATACCGCTTTTTGTTTGAGCAGTAGCAATTACAGCTTTACTTTTACTTTTATCCCTGCCTGTTTTAGCA"
# "00000000000000000000000000011111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111221111111111111111111111111101111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111000000000000000000000000000000000000000110000000000000000000001110000000001000000000000000000000000"
# "---------------------------gccggaatagtagggacatctataagtttactaattcgatcagaattagggatgcctgggacattaattggtaatgaccaaatttataatgttattgtt------catgcatttattataattttttttatagttataccaattataattgggggatttggtaattgattagtccctttaatattgggggcccctgatatagctttccctcgaataaataatataagattttgacttttacctccttctttaactttacttcttataagaagaatggtagaaagaggg------acaggatggacagtttacccccctttatcagcgaatattgcccatggaggttcttcggtagatttagctatttttagtttacacttagcaggtatttcatctatcctcggtgcagttaattttattacaactgtaattaacatacgacctgaaggaataaccttagatcgaataccgctttttgtttgagcagtagcaattacagctttacttttacttttatccctgcctgt"
# "---------------------------gccggaatagtagggacatctataagtttactaattcgatcagaattagggatgcctgggacattaattggtaatgaccaaatttataatgttattgtt-------atgcatttattataattttt------gttataccaattataattgggggatttggtaattgattagtccctttaatattgggggcccctgatatagctttccctcgaataaataatataagattttgacttttacctccttctttaactttacttcttataagaagaatggtagaaagaggg------acaggatggacagtttacccccctttatcagcgaatattgcccatggaggttcttcggtagatttagctatttttagtttacacttagcaggtatttcatctatcctcggtgcagttaattttattacaactgtaattaacatacgacctgaaggaataaccttagatcgaataccgctttttgtttgagcagtagcaattacagctttacttttacttttatccctgcctgt"
# "---------------------------gccggaatagtagggacatctataagtttactaattcgatcagaattagggatgcctgggacattaattggtaatgaccaaatttataatgttattgtt------catgcatttattataatttt-------gttataccaattataattgggg-atttggtaattgattagtccctttaatattgggggcccctgatatagctttccctcgaataaataatataagattttgacttttacctccttctttaactttacttcttataagaagaatggtagaaagaggggcagggacaggatggacagtttacccccctttatcagcgaatattgcccatggaggttcttcggtagatttagctatttttagtttacacttagcaggtatttcatctatcctcggtgcagttaattttattacaactgtaattaacatacgacctgaaggaataaccttagatcgaataccgctttttgtttgagcagtagcaattacagctttacttttacttttatccctgcctgt"
# "NNNNNNNNNNNNNNNNNNNNNNNNNNNGCCGGAATAGTAGGGACATCTATAAGTTTACTAATTCGATCAGAATTAGGGATGCCTGGGACATTAATTGGTAATGACCAAATTTATAATGTTATTGTTNNNNNNCATGCATTTATTATAATTTTTTTTATAGTTATACCAATTATAATTGGGGGATTTGGTAATTGATTAGTCCCTTTAATATTGGGGGCCCCTGATATAGCTTTCCCTCGAATAAATAATATAAGATTTTGACTTTTACCTCCTTCTTTAACTTTACTTCTTATAAGAAGAATGGTAGAAAGAGGGGCAGGGACAGGATGGACAGTTTACCCCCCTTTATCAGCGAATATTGCCCATGGAGGTTCTTCGGTAGATTTAGCTATTTTTAGTTTACACTTAGCAGGTATTTCATCTATCCTCGGTGCAGTTAATTTTATTACAACTGTAATTAACATACGACCTGAAGGAATAACCTTAGATCGAATACCGCTTTTTGTTTGAGCAGTAGCAATTACAGCTTTACTTTTACTTTTATCCCTGCCTGT"
# "---------------------------GCCGGAATAGTAGGGACATCTATAAGTTTACTAATTCGATCAGAATTAGGGATGCCTGGGACATTAATTGGTAATGACCAAATTTATAATGTTATTGTTACAGCTCATGCATTTATTATAATTTTTTTTATAGTTATACCAATTATAATTGGGGGATTTGGTAATTGATTAGTCCCTTTAATATTGGGGGCCCCTGATATAGCTTTCCCTCGAATAAATAATATAAGATTTTGACTTTTACCTCCTTCTTTAACTTTACTTCTTATAAGAAGAATGGTAGAAAGAGGGGCAGGGACAGGATGGACAGTTTACCCCCCTTTATCAGCGAATATTGCCCATGGAGGTTCTTCGGTAGATTTAGCTATTTTTAGTTTACACTTAGCAGGTATTTCATCTATCCTCGGTGCAGTTAATTTTATTACAACTGTAATTAACATACGACCTGAAGGAATAACCTTAGATCGAATACCGCTTTTTGTTTGAGCAGTAGCAATTACAGCTTTACTTTTACTTTTATCCCTGCCTGTTTTAGCA-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------"
# 
# #censor length == 0 then the problem is solved?
# "---------------------------gccggaatagtagggacatctataagtttactaattcgatcagaattagggatgcctgggacattaattggtaatgaccaaatttataatgttattgttacagctcatgcatttattataattttttttatagttataccaattataattgggggatttggtaattgattagtccctttaatattgggggcccctgatatagctttccctcgaataaataatataagattttgacttttacctccttctttaactttacttcttataagaagaatggtagaaagaggggcagggacaggatggacagtttacccccctttatcagcgaatattgcccatggaggttcttcggtagatttagctatttttagtttacacttagcaggtatttcatctatcctcggtgcagttaattttattacaactgtaattaacatacgacctgaaggaataaccttagatcgaataccgctttttgtttgagcagtagcaattacagctttacttttacttttatccctgcctgt"
# "---------------------------gccggaatagtagggacatctataagtttactaattcgatcagaattagggatgcctgggacattaattggtaatgaccaaatttataatgttattgttacagctcatgcatttattataattttttt-atagttataccaattataattgggggatttggtaattgattagtccctttaatattgggggcccctgatatagctttccctcgaataaataatataagattttgacttttacctccttctttaactttacttcttataagaagaatggtagaaagaggggcagggacaggatggacagtttacccccctttatcagcgaatattgcccatggaggttcttcggtagatttagctatttttagtttacacttagcaggtatttcatctatcctcggtgcagttaattttattacaactgtaattaacatacgacctgaaggaataaccttagatcgaataccgctttttgtttgagcagtagcaattacagctttacttttacttttatccctgcctgt"
# "---------------------------gccggaatagtagggacatctataagtttactaattcgatcagaattagggatgcctgggacattaattggtaatgaccaaatttataatgttattgttacagctcatgcatttattataattttttttatagttataccaattataattgggg-atttggtaattgattagtccctttaatattgggggcccctgatatagctttccctcgaataaataatataagattttgacttttacctccttctttaactttacttcttataagaagaatggtagaaagaggggcagggacaggatggacagtttacccccctttatcagcgaatattgcccatggaggttcttcggtagatttagctatttttagtttacacttagcaggtatttcatctatcctcggtgcagttaattttattacaactgtaattaacatacgacctgaaggaataaccttagatcgaataccgctttttgtttgagcagtagcaattacagctttacttttacttttatccctgcctgt"
# "NNNNNNNNNNNNNNNNNNNNNNNNNNNGCCGGAATAGTAGGGACATCTATAAGTTTACTAATTCGATCAGAATTAGGGATGCCTGGGACATTAATTGGTAATGACCAAATTTATAATGTTATTGTTACAGCTCATGCATTTATTATAATTTTTTTTATAGTTATACCAATTATAATTGGGGGATTTGGTAATTGATTAGTCCCTTTAATATTGGGGGCCCCTGATATAGCTTTCCCTCGAATAAATAATATAAGATTTTGACTTTTACCTCCTTCTTTAACTTTACTTCTTATAAGAAGAATGGTAGAAAGAGGGGCAGGGACAGGATGGACAGTTTACCCCCCTTTATCAGCGAATATTGCCCATGGAGGTTCTTCGGTAGATTTAGCTATTTTTAGTTTACACTTAGCAGGTATTTCATCTATCCTCGGTGCAGTTAATTTTATTACAACTGTAATTAACATACGACCTGAAGGAATAACCTTAGATCGAATACCGCTTTTTGTTTGAGCAGTAGCAATTACAGCTTTACTTTTACTTTTATCCCTGCCTGT"
# toy4_expected= 
#   
# test_toy4 = build_ccs(x =toy_example4,
# 						id = "toy_example4-long_and_messy", 
# 						order = "coleoptera")	
# 
# test_toy4_out = denoise(test_toy4, 
# 		ambig_char = "N",
# 		censor_length = 0,
# 		aa_check = FALSE, 
# 		to_file = FALSE)
# 
# 
# for(x in 1:3){
#   print(paste(test_toy4_out$adjusted_sequences[[x]], collapse = ''))
# }
# 
# for(x in 1:3){
#   print(paste(test_toy4_out$data$paths[[x]], collapse = ''))
# }
# 
# 
# expect_equal(test_toy4_out$consensus, toy4_expected)
# 
# test_toy4_out$consensus
# 
# 
# 
# 
# 
# 
# #synthetic examples
# 
# #PACBB001-16
# order1 = 'archaeognatha'
# starting_sequence1 = 'TTAATTTTTGGTGTATGAGCAGGGATAATTGGTACTTCTTTAAGTGTATTAATTCGCGCCGAACTAGGCCAACCTGGTAGCCTTATTGGAGATGATCAAATCTATAATGTTATTGTCACCGCCCACGCTTTTATTATAATTTTTTTTATGGTTATACCAATTATAATTGGGGGTTTTGGAAATTGACTAGTTCCTTTAATGCTTGGGGCCCCAGATATAGCTTTTCCCCGTCTTAATAATATAAGATTTTGATTACTCCCACCAGCATTACTTCTTCTCTTATCGGGAAGTGTTGTAGAAAGAGGCGCCGGAACTGGTTGAACTGTTTATCCACCTTTATCTTCAGGGTTAGCCCATGCTGGCGCTTCAGTTGATTTATCTATTTTTTCCTTGCACCTTGCTGGTGTTTCATCTATTTTAGGTGCTGCTAATTTTATTACCACAGTAATCAATATACGTTCAAGAGGAATAACATTAGACCGAATGCCCTTATTTGTTTGGTCTGTGGTTATTACAGCTGTCCTTCTTCTTTTATCCCTCCCTGTTCTCGCT'
# 
# fake_ccs_data1 = list(
# 	'TTAATTTTTGGTGTATGAGCAGGGATAATTGGTACTTCTTTTAAGTGTATTAATTCGCGCCGAACTAGGCCAACCTGGTAGCCTTATTGGAGATGATCAAATCTATAATGTTATTGTCACCGCCCACGCTTTTATTATAATTTTTTTTATGGTTATACCAATTATAATTGGGGGTTTTGGAAATTGACTAGTTCCTTTAATGCTTGGGGCCCCAGATATAGCTTTTCCCCGTCTTAATAATATAAGATTTTGATTACTCCCACCAGCATTACTTCTTCTCTTATCGGGAAGTGTTGTAGAAAGAGGCGCCGGAACTGGTTGAACTGTTTATCCACCTTTATCTTCAGGGTTAGCCCATGCTGGCGCTTCAGTTGATTTATCTATTTTTTCCTTGCACCTTGCTGGTGTTTCATCTATTTTAGGTGCTGCTAATTTTATTACCACAGTAATCAATATACGTTCAAGAGGAATAACATTAGACCGAATGCCCTTATTTGTTTGGTCTGTGGTTATTAC',
# 	'CTTCTTTAAGTGTATTAATTCGCGCCGAACTAGGCCAACCTGGTAGCCTTATTGGAGATGATCAAATCTATAATGTTATTGTCACCGCCCACGCTTTTATTATAATTTTTTTTATGGTTATACCAATTATAATTGGGGGTTTTGGAAATTGACTAGTTCCTTTAATGCTTGGGGCCCCAGATATAGCTTTTCCCCGTCTTAATAATATAAGATTTTGATTACTCCCACCAGCATTACTTCTTCTCTTATCGGGAAGTGTTGTAGAAAGAGGCGCCGGAACTGGTTGAACTGTTTATCCACCTTTATCTTCAGGGTTAGCCCATGCTGGCGCTTCAGTTGATTTATCTATTTTTTTCCTTGCACCTTGCTGGTGTTTCATCTATTTTAGGTGCTGCTAATTTTATTACCACAGTAATCAATATACGTTCAAGAGGAATAACATTAGACCGAATGCCCTTATTTGTTTGGTCTGTGGTTATTACAGCTGTCCTTCTTCTTTTATCCCTCCCTGTTCTCGCT',
# 	'TTAATTTTTGGTGTATGAGCAGGGATAATTGGTACTTCTTTAAGTGTATTAATTCGCGCCGAACTAGGCCAACCTGGTAGCCTTATTGGAGATGATCAAATCTATAATGTTATTGTCACCGCCCACGCTTTTATTATAATTTTTTTATGGTTATACCAATTATAATTGGGGGTTTTGGAAATTGACTAGTTCCTTTAATGCTTGGGGCCCCAGATATAGCTTTTCCCCGTCTTAATAATATAAGATTTTGATTACTCCCACCAGCATTACTTCTTCTCTTATCGGGAAGTGTTGTAGAAAGAGGCGCCGGAACTGGTTGAACTGTTTATCCACCTTTATCTTCAGGGTTAGCCCATGCTGGCGCTTTCAGTTGATTTATCTATTTTTTCCTTGCACCTTGCTGGTGTTTCATCTATTTTAGGTGCTGCTAATTTTATTACCACAGTAATCAATATACGTTCAAGAGGAATAACATTAGACCGAATGCCCTTATTTGTTTGGTCTGTGGTTATTACAGCTGTCCTTCTTCTTTTATCCCTCCCTGTTCTCGCT'	
# 	)
# 
# 
# 
# 
# #PACBB6596-16
# order2 = 'lepidoptera'
# starting_sequence2 = 'TTTATTTTTGGAATTTGATCCGGAATAATTGGAACATCTCTTAGTCTATTAATTCGTGCTGAATTAGGAAACCCAGGCTCTTTAATTGGAGATGATCAAATTTATAATACAATTGTTACCGCCCACGCCTTTATTATAATTTTTTTCATGGTTATACCAATTATAATTGGAGGATTTGGAAATTGATTAGTACCTTTAATATTAGGAGCTCCTGATATAGCTTTCCCCCGAATAAATAATATAAGATTTTGATTACTTCCCCCTTCACTTACTTTATTAGTTTCTAGAAGAATTGTAGAAAATGGAGTAGGAACAGGATGAACAGTATACCCCCCTTTATCTTCTAATATTGCCCATGGTGGAGGCTCTGTTGATTTAGCAATCTTTTCTCTTCATTTAGCTGGAATTTCTTCAATTTTAGGAGCTGTCAATTTTATTACAACAGTAATTAATATACGAACAAATGGTATATCTTTTGATCGAATACCATTATTTGTTTGATCTGTTGCTATCACAGCACTTCTACTACTTTTATCTTTACCTGTCTTAGCTGGAGCTATTACTATACTTTTAACTGAT'
# 
# 
# 
# #PACBB8835-16
# order3 = 'Coleoptera'
# sarting_sequence3 = 'TTTATTTTTGGAGCTTGAGCCGGACTTGTAGGAACTTCTATAAGTATAATTATTCGAACAGAATTAGGTAATCCAGGCTCTTTGATTGGTAATGATCAAATTTATAATGTAATTGTAACTGCCCATGCATTTATTATAATTTTTTTCATAGTAATACCTATCACAATAGGGGGTTTTGGAAATTGATTAGTTCCATTAATAATTGGTGCTCCTGATATAGCATTTCCTCGAATAAACAACATAAGATTTTGATTATTACCCCCTTCTTTAATACTTCTCTTAATAAGAAGAATTGTAGAAAGAGGAGCAGGTACAGGATGAACAGTTTATCCTCCCTTATCTTCCAATATTGCCCATGGAGGATCTTCAGTTGATTTAGCTATTTTCAGTTTACACTTAGCAGGGATTTCCTCAATTCTTGGGGCTATCAACTTTATTACAACAATTATTAATATGCGCCCTGTAGGCATAACTTTAGATCGAATACCTTTATTTGTATGATCAGTTATTATTACAGCT'
# 
# fake_ccs_data3 = list(
# 
# 	)
