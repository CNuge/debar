


test_that("CCS sequences with indels added are denoised to the correct sequence.", {


	#####################################3
	# test 1
	order1 = 'archaeognatha'
	starting_sequence1 = 'TTAATTTTTGGTGTATGAGCAGGGATAATTGGTACTTCTTTAAGTGTATTAATTCGCGCCGAACTAGGCCAACCTGGTAGCCTTATTGGAGATGATCAAATCTATAATGTTATTGTCACCGCCCACGCTTTTATTATAATTTTTTTTATGGTTATACCAATTATAATTGGGGGTTTTGGAAATTGACTAGTTCCTTTAATGCTTGGGGCCCCAGATATAGCTTTTCCCCGTCTTAATAATATAAGATTTTGATTACTCCCACCAGCATTACTTCTTCTCTTATCGGGAAGTGTTGTAGAAAGAGGCGCCGGAACTGGTTGAACTGTTTATCCACCTTTATCTTCAGGGTTAGCCCATGCTGGCGCTTCAGTTGATTTATCTATTTTTTCCTTGCACCTTGCTGGTGTTTCATCTATTTTAGGTGCTGCTAATTTTATTACCACAGTAATCAATATACGTTCAAGAGGAATAACATTAGACCGAATGCCCTTATTTGTTTGGTCTGTGGTTATTACAGCTGTCCTTCTTCTTTTATCCCTCCCTGTTCTCGCT'
	consensus1_sequence_expected = paste('NNNNNNNNN', starting_sequence1, sep = "")

	fake_ccs_data1 = list(
		'TTAATTTTTGGTGTATGAGCAGGGATAATTGGTACTTCTTTTAAGTGTATTAATTCGCGCCGAACTAGGCCAACCTGGTAGCCTTATTGGAGATGATCAAATCTATAATGTTATTGTCACCGCCCACGCTTTTATTATAATTTTTTTTATGGTTATACCAATTATAATTGGGGGTTTTGGAAATTGACTAGTTCCTTTAATGCTTGGGGCCCCAGATATAGCTTTTCCCCGTCTTAATAATATAAGATTTTGATTACTCCCACCAGCATTACTTCTTCTCTTATCGGGAAGTGTTGTAGAAAGAGGCGCCGGAACTGGTTGAACTGTTTATCCACCTTTATCTTCAGGGTTAGCCCATGCTGGCGCTTCAGTTGATTTATCTATTTTTTCCTTGCACCTTGCTGGTGTTTCATCTATTTTAGGTGCTGCTAATTTTATTACCACAGTAATCAATATACGTTCAAGAGGAATAACATTAGACCGAATGCCCTTATTTGTTTGGTCTGTGGTTATTAC',
		'CTTCTTTAAGTGTATTAATTCGCGCCGAACTAGGCCAACCTGGTAGCCTTATTGGAGATGATCAAATCTATAATGTTATTGTCACCGCCCACGCTTTTATTATAATTTTTTTTATGGTTATACCAATTATAATTGGGGGTTTTGGAAATTGACTAGTTCCTTTAATGCTTGGGGCCCCAGATATAGCTTTTCCCCGTCTTAATAATATAAGATTTTGATTACTCCCACCAGCATTACTTCTTCTCTTATCGGGAAGTGTTGTAGAAAGAGGCGCCGGAACTGGTTGAACTGTTTATCCACCTTTATCTTCAGGGTTAGCCCATGCTGGCGCTTCAGTTGATTTATCTATTTTTTTCCTTGCACCTTGCTGGTGTTTCATCTATTTTAGGTGCTGCTAATTTTATTACCACAGTAATCAATATACGTTCAAGAGGAATAACATTAGACCGAATGCCCTTATTTGTTTGGTCTGTGGTTATTACAGCTGTCCTTCTTCTTTTATCCCTCCCTGTTCTCGCT',
		'TTAATTTTTGGTGTATGAGCAGGGATAATTGGTACTTCTTTAAGTGTATTAATTCGCGCCGAACTAGGCCAACCTGGTAGCCTTATTGGAGATGATCAAATCTATAATGTTATTGTCACCGCCCACGCTTTTATTATAATTTTTTTATGGTTATACCAATTATAATTGGGGGTTTTGGAAATTGACTAGTTCCTTTAATGCTTGGGGCCCCAGATATAGCTTTTCCCCGTCTTAATAATATAAGATTTTGATTACTCCCACCAGCATTACTTCTTCTCTTATCGGGAAGTGTTGTAGAAAGAGGCGCCGGAACTGGTTGAACTGTTTATCCACCTTTATCTTCAGGGTTAGCCCATGCTGGCGCTTTCAGTTGATTTATCTATTTTTTCCTTGCACCTTGCTGGTGTTTCATCTATTTTAGGTGCTGCTAATTTTATTACCACAGTAATCAATATACGTTCAAGAGGAATAACATTAGACCGAATGCCCTTATTTGTTTGGTCTGTGGTTATTACAGCTGTCCTTCTTCTTTTATCCCTCCCTGTTCTCGCT'	
		)

	fake_ccs_1 = build_ccs(x =fake_ccs_data1,
							id = "Fake indel ccs test 1", 
							order = order1)	


	fake_ccs_1 = frame(fake_ccs_1)
	fake_ccs_1 = adjust(fake_ccs_1)
	#TODO - add this test in if you add the aa_check function
	#    x = aa_check(x)
	fake_ccs_1 = consensus(fake_ccs_1)

	#fake_ccs_1$consensus == consensus1_sequence_expected
	# test below accounts for fact the denoiser is dropping the last bp... an acceptable change.
	expect_equal(fake_ccs_1$consensus , substr(consensus1_sequence_expected, 1, nchar(consensus1_sequence_expected)-1 ))

	
	#####################################3
	# test 2

	order2 = 'lepidoptera'
	starting_sequence2 = 'TTTATTTTTGGAATTTGATCCGGAATAATTGGAACATCTCTTAGTCTATTAATTCGTGCTGAATTAGGAAACCCAGGCTCTTTAATTGGAGATGATCAAATTTATAATACAATTGTTACCGCCCACGCCTTTATTATAATTTTTTTCATGGTTATACCAATTATAATTGGAGGATTTGGAAATTGATTAGTACCTTTAATATTAGGAGCTCCTGATATAGCTTTCCCCCGAATAAATAATATAAGATTTTGATTACTTCCCCCTTCACTTACTTTATTAGTTTCTAGAAGAATTGTAGAAAATGGAGTAGGAACAGGATGAACAGTATACCCCCCTTTATCTTCTAATATTGCCCATGGTGGAGGCTCTGTTGATTTAGCAATCTTTTCTCTTCATTTAGCTGGAATTTCTTCAATTTTAGGAGCTGTCAATTTTATTACAACAGTAATTAATATACGAACAAATGGTATATCTTTTGATCGAATACCATTATTTGTTTGATCTGTTGCTATCACAGCACTTCTACTACTTTTATCTTTACCTGTCTTAGCTGGAGCTATTACTATACTTTTAACTGAT'
	consensus2_sequence_expected = paste('NNNNNNNNN', starting_sequence2, sep = "")



	fake_ccs_data2 = list(
		'GAACATCTCTTAGTCTATTAATTCGTGCTGAATTAGGAAACCCAGGCTCTTTAATTGGAGATGATCAAATTTTTATAATACAATTGTTACCGCCCACGCCTTTATTATAATTTTTTTCATGGTTATACCAATTATAATTGGAGGATTTGGAAATTGATTAGTACCTTTAATATTAGGAGCTCCTGATATAGCTTTCCCCCGAATAAATAATATAAGATTTTGATTACTTCCCCCTTCACTTACTTTATTAGTTTCTAGAAGAATTGTAGAAAATGGAGTAGGAACAGGATGAACAGTATACCCCCCTTTATCTTCTAATATTGCCCATGGTGGAGGCTCTGTTGATTTAGCAATCTTTTCTCTTCATTTAGCTGGAATTTCTTCAATTTTAGGAGCTGTCAATTTTATTACAACAGTAATTAATATACGAACAAATGGTATATCTTTTGATCGAATACCATTATTTGTTTGATCTGTTGCTATCACAGCACTTCTACTACTTTTATCTTTACCTGTCTTAGCTGGAGCTATTACTATACTTTTAACTGAT',
		'TTTATTTTTGGAATTTGATCCGGAATAATTGGAACATCTCTTAGTCTATTAATTCGTGCTGAATTAGGAAACCCAGGCTCTTTAATTGGAGATGATCAAATTTATAATACAATTGTTACCGCCCACGCCTTTATTATAATTTTTTTCATGGTTATACCAATTATAATTGGAGGATTTGGAAATTGATTAGTACCTTTAATATTAGGAGCTCCTGATATAGCTTTCCCCCGAATAAATAATATAAGATTTTGATTACTTCCCCCTTCACTTACTTTATTAGTTTCTAGAAGAATTGTAGAAAATGGAGTAGGAACAGGATGAACAGTATACCCCCCTTTATCTTCTAATATTGCCCATGGTGGAGGCTCTGTTGATTTAGCAATCTTTTCTCTTCATTTAGCTGGAATTTCTTCAATTTTAGGAGCTGTCAATTTTATTACAACAGTAATTAATATACGAACAAATGGTATATCTTTTGATCGAATACCATTATTTGTT',
		'TTTATTTTTGGAATTTGATCCGGAATAATTGGAACATCTCTTAGTCTATTAATTCGTGCTGAATTAGGAAACCCAGGCTCTTTAATTGGAGATGATCAAATTTATAATACAATTGTTACCGCCCACGCCTTTATTATAATTTTTTTCATGGTTATACCAATTATAATTGGAGGATTTGGAAATTGATTAGTACCTTTAATATTAGGAGCTCCTGATATAGCTTTCCCCCGAATAAATAATATAAGATTTTGATTACTTCCCCCTTCACTTACTTTATTAGTTTCTAGAAGAATTGTAGAAAATGGAGTAGGAACAGGATGAACAGTATACCCCCCTTTATCTTCTAATATTGCCCATGGTGGAGGCTCTGTTGATTTAGCAATCTTTTTTCTCTTCATTTAGCTGGAATTTCTTCAATTTTAGGAGCTGTCAATTTTATTACAACAGTAATTAATATACGAACAAATGGTATATCTTTTGATCGAATACCATTATTTGTTTGATCTGTTGCTATCACAGCACTTCTACTACTTTTATCTTTACCTG',
		'TTTATTTTTGGAATTTGATCCGGAATAATTGGAACATCTCTTAGTCTATTAATTCGTGCTGAATTAGGAAACCCAGGCTCTTTAATTGGAGATGATCAAATTTATAATACAATTGTTACCGCCCACGCCTTTATTATAATTTTTTTCATGGTTATACCAATTATAATTGGAGGATTTGGAAATTGATTAGTACCTTTAATATTAGGAGCTCCTGATATAGCTTTCCCCCCGAATAAATAATATAAGATTTTGATTACTTCCCCCTTCACTTACTTTATTAGTTTCTAGAAGAATTGTAGAAAATGGAGTAGGAACAGGATGAACAGTATACCCCCCTTTATCTTCTAATATTGCCCATGGTGGAGGCTCTGTTGATTTAGCAATCTTTTCTCTTCATTTAGCTGGAATTTCTTCAATTTTAGGAGCTGTCAATTTTATTACAACAGTAATTAATATACGAACAAATGGTATATCTTTTGATCGAATACCATTATTTGTTTGATCTGTTGCTATCACAGCACTTCTACTACTTTTATCTTTACCTGTCTTAGCTGGAGCTATTACTATACTTTTAACTGAT'
		)

	fake_ccs_2 = build_ccs(x = fake_ccs_data2,
							id = "Fake indel ccs test 2", 
							order = order2)	


	fake_ccs_2 = frame(fake_ccs_2)
	fake_ccs_2 = adjust(fake_ccs_2)
	#TODO - add this test in if you add the aa_check function
	#    x = aa_check(x)
	fake_ccs_2 = consensus(fake_ccs_2)

	#fake_ccs_2$consensus == substr(consensus2_sequence_expected, 1, nchar(consensus2_sequence_expected)-5 )
	expect_equal(fake_ccs_2$consensus , substr(consensus2_sequence_expected, 1, nchar(consensus2_sequence_expected)-5 ))



	#####################################3
	# test 3
	order3 = 'Coleoptera'
	#note the one N after the homopolymer T tract
	#this was added to the expected, as its not making complete correction and cannot
	#determine consensus for the bp
	starting_sequence3 = 'TTTATTTTTGGAGCTTGAGCCGGACTTGTAGGAACTTCTATAAGTATAATTATTCGAACAGAATTAGGTAATCCAGGCTCTTTGATTGGTAATGATCAAATTTATAATGTAATTGTAACTGCCCATGCATTTATTATAATTTTTTTCATAGTAATACCTATCACAATAGGGGGTTTTGGAAATTGATTAGTTCCATTAATAATTGGTGCTCCTGATATAGCATTTCCTCGAATAAACAACATAAGATTTTGATTATTACCCCCTTCTTTAATACTTCTCTTAATAAGAAGAATTGTAGAAAGAGGAGCAGGTACAGGATGAACAGTTTATCCTCCCTTATCTTCCAATATTGCCCATGGAGGATCTTCAGTTGATTTAGCTATTTTCAGTTTACACTTAGCAGGGATTTCCTCAATTCTTGGGGCTATCAACTTTATTACAACAATTATTAATATGCGCCCTGTAGGCATAACTTTAGATCGAATACCTTTATTTGTATGATCAGTTATTATTACAGCT'
  
	consensus3_sequence_expected = paste('NNNNNNNNN', starting_sequence3, sep = "")

	fake_ccs_data3 = list(
		'TTTATTTTTGGAGCTTGAGCCGGACTTGTAGGAACTTCTATAAGTATAATTATTCGAACAGAATTAGGTAATCCAGGCTCTTTGATTGGTAATGATCAAATTTATAATGTAATTGTAACTGCCCATGCATTTATTATAATTTTTTTTTTCATAGTAATACCTATCACAATAGGGGGTTTTGGAAATTGATTAGTTCCATTAATAATTGGTGCTCCTGATATAGCATTTCCTCGAATAAACAACATAAGATTTTGATTATTACCCCCTTCTTTAATACTTCTCTTAATAAGAAGAATTGTAGAAAGAGGAGCAGGTACAGGATGAACAGTTTATCCTCCCTTATCTTCCAATATTGCCCATGGAGGATCTTCAGTTGATTTAGCTATTTTCAGTTTACACTTAGCAGGGATTTCCTCAATTCTTGGGGCTATCAACTTTATTACAACAATTATTA',
		'TTTATTTTTGGAGCTTGAGCCGGACTTGTAGGAACTTCTATAAGTATAATTATTCGAACAGAATTAGGTAATCCAGGCTCTTTGATTGGTAATGATCAAATTTATAATGTAATTGTAACTGCCCATGCATTTATTATAATTTTTTTTCATAGTAATACCTATCACAATAGGGGGTTTTGGAAATTGATTAGTTCCATTAATAATTGGTGCTCCTGATATAGCATTTCCTCGAATAAACAACATAAGATTTTGATTATTACCCCCTTCTTTAATACTTCTCTTAATAAGAAGAATTGTAGAAAGAGGAGCAGGTACAGGATGAACAGTTTATCCTCCCTTATCTTCCAATATTGCCCATGGAGGATCTTCAGTTGATTTAGCTATTTTCAGTTTACACTTAGCAGGGATTTCCTCAATTCTTGGGGCTATCAACTTTATTACAACAATTATTAATATGCGCCCTGTAGGCATAACTTTAGATCGAATACCTTTATTTGTATGATCAGTTATTATTACAGCT',
		'CTTGAGCCGGACTTGTAGGAACTTCTATAAGTATAATTATTCGAACAGAATTAGGTAATCCAGGCTCTTTGATTGGTAATGATCAAATTTATAATGTAATTGTAACTGCCCATGCATTTATTATAATTTTTTTCATAGTAATACCTATCACAATAGGGGGTTTTGGAAATTGATTAGTTCCATTAATAATTGGTGCTCCTGATATAGCATTTCCTCGAATAAACAACATAAGATTTTGATTATTACCCCCTTCTTTAATACTTCTCTTAATAAGAAGAATTGTAGAAAGAGGAGCAGGTACAGGATGAACAGTTTATCCTCCCTTATCTTCCAATATTGCCCATGGAGGATCTTCAGTTGATTTAGCTATTTTCAGTTTACACTTAGCAGGGATTTCCTCAATTCTTGGGGGCTATCAACTTTATTACAACAATTATTAATATGCGCCCTGTAGGCATAACTTTAGATCGAATACCTTTATTTGTATGATCAGTTATTATTACAGCT',
		'TTTATTTTTGGAGCTTGAGCCGGACTTGTAGGAACTTCTATAAGTATAATTATTCGAACAGAATTAGGTAATCCAGGCTCTTTGATTGGTAATGATCAAATTTATAATGTAATTGTAACTGCCCATGCATTTATTATAATTTTTTCATAGTAATACCTATCACAATAGGGGGTTTTGGAAATTGATTAGTTCCATTAATAATTGGTGCTCCTGATATAGCATTTCCTCGAATAAACAACATAAGATTTTGATTATTACCCCCTTCTTTAATACTTCTCTTAATAAGAAGAATTGTAGAAAGAGGAGCAGGTACAGGATGAACAGTTTATCCTCCCTTATCTTCCAATATTGCCCATGGAGGATCTTCAGTTGATTTAGCTATTTTCAGTTTACACTTAGCAGGGATTTCCTCAATTCTTGGGGCTATCAACTTTATTACAACAATTATTAATATGCGCCCTGTAGGCATAACTTTAGATCGAATACCTTTATTTGTATGA'
		)

	fake_ccs_3 = build_ccs(x =fake_ccs_data3,
							id = "Fake indel ccs test 1", 
							order = order3)	

	fake_ccs_3 = frame(fake_ccs_3)
	fake_ccs_3 = adjust(fake_ccs_3)
	fake_ccs_3 = consensus(fake_ccs_3)

	#fake_ccs_3$consensus == substr(consensus3_sequence_expected, 1, nchar(consensus3_sequence_expected)-13 ) 
	expect_equal(fake_ccs_3$consensus , substr(consensus3_sequence_expected, 1, nchar(consensus3_sequence_expected)-13 ) )

	
	#####################################3
	# test 4

	order4 = 'diptera'
	sarting_sequence4 = 'ACTCTATACTTCATTTTTGGGGCCTGAGCTAGAATAGTTGGAACATCTCTAAGTATATTAATTCGAGCTGAATTAGGTTGCCCCAATGCATTAATTGGAGATGATCAAATTTACAATGTAATTGTAACTGCTCATGCTTTTATCATAATTTTTTTTATAGTAATACCAATTATAATTGGGGGATTCGGGAATTGATTAGTTCCATTAATATTATCAGCCCCTGATATAGCTTTCCCTCGATTAAATAATATAAGTTTTTGATTACTCCCACCTTCTTTAACTTTACTATTAACAAGTAGATTAGTAGAAAGTGGAACAGGGACAGGATGAACAGTTTATCCACCATTATCTTCTACCCTTAGTCATTCAGGAGCATCTGTTGACCTATCAATTTTTTCACTTCATTTAGCAGGTATTTCATCCATTTTAGGAGCTGTAAATTTTATTTCCACTATTATTAACATACGAGCCCCTGGAATATCTTTTGATAAAATACCTTTATTTGTATGATCTGTTTTAATTACAGCTATCTTACTTTTATTATCTCTTCCTGTTTTAGCAGGGGCTATTACTATACTTCTTACAGAT'
	consensus4_sequence_expected = sarting_sequence4

	fake_ccs_data4 = list(
		'TAATTCGAGCTGAATTAGGTTGCCCCAATGCATTAATTGGAGATGATCAAATTTACAATGTAATTGTAACTGCTCATGCTTTTATCATAATTTTTTTTATAGTAATACCAATTATAATTGGGGGATTCGGGAATTGATTAGTTCCATTAATATTATCAGCCCCTGATATAGCTTTCCCTCGATTAAATAATATAAGTTTTTGATTACTCCCACCTTCTTTAACTTTACTATTAACAAGTAGATTAGTAGAAAGTGGAACAGGGACAGGATGAACAGTTTATCCACCATTATCTTCTACCCTTAGTCATTCAGGAGCATCTGTTGACCTATCAATTTTTTCACTTCATTTAGCAGGTATTTCATCCATTTTAGGAGCTGTAAATTTTATTTCCACTATTATTAACATACGAGCCCCTGGAATATCTTTTGATAAAATACCTTTATTTGTATGATCTGTTTTAATTACAGCTATCTTACTTTTATTATCTCTTCCTGTTTTAGCAGGGGCTATTACTATACTTCTTACAGAT',
		'ACTCTATACTTCATTTTTGGGGCCTGAGCTAGAATAGTTGGAACATCTCTAAGTATATTAATTCGAGCTGAATTAGGTTGCCCCAATGCATTAATTGGAGATGATCAAATTTACAATGTAATTGTAACTGCTCATGCTTTTATCATAATTTTTTTTATAGTAATACCAATTATAATTGGGGGATTCGGGAATTGATTAGTTCCATTAATATTATCAGCCCCTGATATAGCTTTCCCTCGATTAAATAATATAAGTTTTTGATTACTCCCACCTTCTTTAACTTTACTATTAACAAGTAGATTAGTAGAAAGTGGAACAGGGACAGGATGAACAGTTTATCCACCATTATCTTCTACCCTTAGTCATTCAGGAGCATCTGTTGACCTATCAATTTTTTCACTTCATTTAGCAGGTATTTCATCCATTTTAGGAGCTGTAAATTTTATTTCCACTATTATTAACATACGAGCCCCTGGAATATCTTTTGATAAAATACCTTTATTTGT',
		'ACTCTATACTTCATTTTTGGGGCCTGAGCTAGAATAGTTGGAACATCTCTAAGTATATTAATTCGAGCTGAATTAGGTTGCCCCAATGCATTAATTGGAGATGATCAAATTTACAATGTAATTGTAACTGCTCATGCTTTTATCATAATTTTTTTTATAGTAATACCAATTATAATTGGGGGATTCGGGAATTGATTAGTTCCATTAATATTATCAGCCCCTGATATAGCTTTCCCTCGATTAAATAATATAAGTTTTTGATTACTCCCACCTTCTTTAACTTTACTATTAACAAGTAGATTAGTAGAAAGTGGAACAGGGACAGGATGAACAGTTTATCCACCATTATCTTCTACCCTTAGTCATTCAGGAGCATCTGTTGACCTATCAATTTTTTTCACTTCATTTAGCAGGTATTTCATCCATTTTAGGAGCTGTAAATTTTATTTCCACTATTATTAACATACGAGCCCCTGGAATATCTTTTGATAAAATACCTTTATTTGTATGATCTGTTTTAATTACAGCTATCTTACTTTTATTATCTCTTCCTGTTTTAGCAGGGGCTATTACTATACTTCTTACAGAT'
		)

	fake_ccs_4 = build_ccs(x =fake_ccs_data4,
							id = "Fake indel ccs test 1", 
							order = order4)	


	fake_ccs_4 = frame(fake_ccs_4)
	fake_ccs_4 = adjust(fake_ccs_4)
	fake_ccs_4 = consensus(fake_ccs_4)

	#fake_ccs_4$consensus  ==  substr(consensus4_sequence_expected, 1, nchar(consensus4_sequence_expected)-7 )
	expect_equal(fake_ccs_4$consensus , substr(consensus4_sequence_expected, 1, nchar(consensus4_sequence_expected)-7 ) )

})

