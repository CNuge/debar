test_that("Read CCS sequences are denoised to the correct sequence.", {

###########################################3
# test of weird set 1
expected_consensus1 = "ACGCTGTACTTAATTTTTGGTGTATGAGCAGGGATAATTGGTACTTCTTTAAGTGTATTAATTCGCGCCGAACTAGGCCAACCTGGTAGCCTTATTGGAGATGATCAAATCTATAATGTTATTGTCACCGCCCACGCTTTTATTATAATTTTTTTTATGGTTATACCAATTATAATTGGNGGTTTTGGAAATTGACTAGTTCCTTTAATGCTTGGGGCCCCAGATATAGCTTTTCCCCGTCTTAATAATATAAGATTTTGANTACTNCCACCAGCATTACTTCTTCTCTTATCGGGAAGTGTTGTAGAAAGAGGCGCCGGAACTGGTTGAACTGTTTATCCACCTTTATCTTCAGGGTTAGCCCATGCTGGCGCTTCAGTTGATTTATCTATTTTTTCCTTGCACCTTGCTGGTGTTTCATCTATTTTAGGTGCTGCTAATTTTATTACCACAGTAATCAATATACGTTCAAGAGGAATAACATTAGACCGAATGCCCTTATTTGTTTGGTCTGTGGTTATTACAGCTGTCCTTCTTCTTTTATCCCTCCCTGTTCTCGCTGGTGCTATTACAATACTCTTGACAGACCGAAATCTTAATACTTCTTTTTTTGACCCCGCTGGTGGTGGGGACCCTATTTTATACCAACATT"
weird_1_sequences = list(
	'GGTCAACCAATCATAAAGATATTGGAACGCTGTACTTAATTTTTGGTGTATGAGCAGGGATAATTGGTACTTCTTTAAGTGTATTAATTCGCGCCGAACTAGGCCAACCTGGTAGCCTTATTGGAGATGATCAAATCTATAATGTTATTGTCACCGCCCACGCTTTTATTATAATTTTTTTTATGGTTATACCAATTATAATTGGGGGTTTTGGAAATTGACTAGTTCCTTTAATGCTTGGGGCCCCAGATATAGCTTTTCCCCGTCTTAATAATATAAGATTTTGATTACTCCCACCAGCATTACTTCTTCTCTTATCGGGAAGTGTTGTAGAAAGAGGCGCCGGAACTGGTTGAACTGTTTATCCACCTTTATCTTCAGGGTTAGCCCATGCTGGCGCTTCAGTTGATTTATCTATTTTTTCCTTGCACCTTGCTGGTGTTTCATCTATTTTAGGTGCTGCTAATTTTATTACCACAGTAATCAATATACGTTCAAGAGGAATAACATTAGACCGAATGCCCTTATTTGTTTGGTCTGTGGTTATTACAGCTGTCCTTCTTCTTTTATCCCTCCCTGTTCTCGCTGGTGCTATTACAATACTCTTGACAGACCGAAATCTTAATACTTCTTTTTTTGACCCCGCTGGTGGTGGGGACCCTATTTTATACCAACATTTATTTTGATTTTTTGGTCATCCATGAAGTTTA',
	'AGTCAACAAATCATAAAGATATTGGAACGCTGTACTTAATTTTTGGTGTATGAGCAGGGATAATTGGTACTTCTTTAAGTGTATTAATTCGCGCCGAACTAGGCCAACCTGGTAGCCTTATTGGAGATGATCAAATCTATAATGTTATTGTCACCGCCCACGCTTTTATTATAATTTTTTTTATGGTTATACCAATTATAATTGGAGGTTTTGGAATTGACTAGTTCCTTTAATGCTTGGGGCCCCAGATATAGCTTTTCCCCGTCTTAATAATATAAGATTTTGACTACTTCCACCAGCATTACTTCTTCTCTTATCGGGAAGTGTTGTAGAAAGAGGCGCCGGAACTGGTTGAACTGTTTATCCACCTTTATCTTCAGGGTTAGCCCATGCTGGCGCTTCAGTTGATTTATCTATTTTTTCCTTGCACCTTGCTGGTGTTTCATCTATTTTAGGTGCTGCTAATTTTATTACCACAGTAATCAATATACGTTCAAGAGGAATAACATTAGACCGAATGCCCTTATTTGTTTGGTCTGTGGTTATTACAGCTGTCCTTCTTCTTTTATCCCTCCCTGTTCTCGCTGGTGCTATTACAATACTCTTGACAGACCGAAATCTTAATACTTCTTTTTTTGACCCCGCTGGTGGTGGGGACCCTATTTTATACCAACATTTATTTTGATTTTTGGACACCCTGAAGTTTA'
	)

	weird_1_ccs	= build_ccs(x = weird_1_sequences,
							id = 'PACBB002-16', 
							order = 'archaeognatha')	

	weird_1_ccs = frame(weird_1_ccs)
	weird_1_ccs = adjust(weird_1_ccs)
	weird_1_ccs = consensus(weird_1_ccs)

	expect_equal(weird_1_ccs$consensus, expected_consensus1)


###########################################3
# test of weird set 2
expected_consensus2 = "NNNTTATATTTTATTTTTGCAATTTGAGCAGGAATAATTGGATCCTCAATAAGAATAATTATTCGATTAGAATTAGGAACTTGCGGGTCCTTAATTTCAAATGATCAAATTTTTAATTCAATTGTTACCGGCCACGCATTTATTATAATTTTTTTTATAGTTATGCCTTTTATAATCGGTGGATTTGGTAATTTTTTAGTACCCCTAATACTTGGAGCACCTGATATAGCCTATCCTCGACTAAATAATATAAGATTTTGACTATTACCACCTTCAATTTTACTATTAACTATCAGAAATTTTATTAATAATGGGGTAGGTACGGGGTGAACTGTTTACCCCCCTTTAGCCTCTAATATTTACCACAATGGCCCATCTGTGGACTTAGCAATTTTTTCCTTACATATTGCAGGAATATCCTCAATTCTCGGAGCAATTAATTTTATTTCTACCATTTTAAATATACATCATAAAAATATTACCCTAGATAAAATCCCTCTTTTAGTATGGTCAATCCTAATCACAGCAATCCTCCTTCTTTTAGCACTCCCTGTTCTAGCTGGAGCTATTACCATGTTACTAACAGATCGTAATCTAAATACTTCTTTCTTCGATCCATCAGGGGGGGGAGACCCCATTCTATACCAACATT"

weird_2_sequences = list(
	'AGTCAACCAATCATAAAGATATTGGCATCTTATATTTTATTTTTGCAATTTGAGCAGGAATAATTGGATCCTCAATAAGAATAATTATTCGATTAGAATTAGGAACTTGCGGGTCCTTAATTTCAAATGATCAAATTTTTAATTCAATTGTTACCGGCCACGCATTTATTATAATTTTTTTTATAGTTATGCCTTTTATAATCGGTGGATTTGGTAATTTTTTAGTACCCCTAATACTTGGAGCACCTGATATAGCCTATCCTCGACTAAATAATATAAGATTTTGACTATTACCACCTTCAATTTTACTATTAACTATCAGAAATTTTATTAATAATGGGGTAGGTACGGGGTGAACTGTTTACCCCCCTTTAGCCTCTAATATTTACCACAATGGCCCATCTGTGGACTTAGCAATTTTTTCCTTACATATTGCAGGAATATCCTCAATTCTCGGAGCAATTAATTTTATTTCTACCATTTTAAATATACATCATAAAAATATTACCCTAGATAAAATCCCTCTTTTAGTATGGTCAATCCTAATCACAGCAATCCTCCTTCTTTTAGCACTCCCTGTTCTAGCTGGAGCTATTACCATGTTACTAACAGATCGTAATCTAAATACTTCTTTCTTCGATCCATCAGGGGGGGGAGACCCCATTCTATACCAACATTTATTTTGATTTTTTGGTCATCCATGAAGTTTA',
	'GTTCAACAAATCATAAAGATATTGGCTATCTTATATTTTATTTTTGCAATTTGAGCAGGAATAATTGGATCCTCAATAAGAATAATTATTCGATTAGAATTAGGAACTTGCGGGTCCTTAATTTCAAATGATCAAATTTTTAATTCAATTGTTACCGGCCACGCATTTATTATAATTTTTTTTATAGTTATGCCTTTTATAATCGGTGGATTTGGTAATTTTTTAGTACCCCTAATACTTGGAGCACCTGATATAGCCTATCCTCGACTAAATAATATAAGATTTTGACTATTACCACCTTCAATTTTACTATTAACTATCAGAAATTTTATTAATAATGGGGTAGGTACGGGGTGAACTGTTTACCCCCCTTTAGCCTCTAATATTTACCACAATGGCCCATCTGTGGACTTAGCAATTTTTTCCTTACATATTGCAGGAATATCCTCAATTCTCGGAGCAATTAATTTTATTTCTACCATTTTAAATATACATCATAAAAATATTACCCTAGATAAAATCCCTCTTTTAGTATGGTCAATCCTAATCACAGCAATCCTCCTTCTTTTAGCACTCCCTGTTCTAGCTGGAGCTATTACCATGTTACTAACAGATCGTAATCTAAATACTTCTTTCTTCGATCCATCAGGGGGGGGAGACCCCATTCTATACCAACATTTATTTTGATTTTTTGGTCATCCAGAAGTTTA',
	'GTTCAACAAATCATAAAGATATTGGCATCTTATATTTTATTTTTGCAATTTGAGCAGGAATAATTGGATCCTCAATAAGAATAATTATTCGATTAGAATTAGGAACTTGCGGGTCCTTAATTTCAAATGATCAAATTTTTAATTCAATTGTTACCGGCCACGCATTTATTATAATTTTTTTTATAGTTATGCCTTTTATAATCGGTGGATTTGGTAATTTTTTAGTACCCCTAATACTTGGAGCACCTGATATAGCCTATCCTCGACTAAATAATATAAGACTTTGACTATTACCACCTTCAATTTTACTATTAACTATCAGAAATTTTATTAATAATGGGGTAGGTACGGGGTGAACTGTTTACCCCCCTTTAGCCTCTAATATTTACCACAATGGCCCATCTGTGGACTTAGCAATTTTTTCCTTACATATTGCAGGAATATCCTCAATTCTCGGAGCAATTAATTTTATTTCTACCATTTTAAATATACATCATAAAAATATTACCCTAGATAAAATCCCTCTTTTAGTATGGTCAATCCTAATCACAGCAATCCTCCTTCTTTTAGCACTCCCTGTTCTAGCTGGAGCTATTACCATGTTACTAACAGATCGTAATCTAAATACTTCTTTCTTCGATCCATCAGGGGGGGGAGACCCCATTCTATACCAACATTTATTTTGATTTTTTGGACATCCAGAAGTTTA',
	'AGTCAACAAATCATAAAGATATTGGCATCTTATATTTTATTTTTGCAATTTGAGCAGGAATAATTGGATCCTCAATAAGAATAATTATTCGATTAGAATTAGGAACTTGCGGGTCCTTAATTTCAAATGATCAAATTTTTAATTCAATTGTTACCGGCCACGCATTTATTATAATTTTTTTTATAGTTATGCCTTTTATAATCGGTGGATTTGGTAATTTTTTAGTACCCCTAATACTTGGAGCACCTGATAGTAGCCTATCCTCGACTAAATAATATAAGATTTTGACTATTACCACCTTCAATTTTACTATTAACTATCAGAAATTTTATTAATAATGGGGTAGGTACGGGGTGAACTGTTTACCCCCCTTTAGCCTCTAATATTTACCACAATGGCCCATCTGTGGACTTAGCAATTTTTTCCTTACATATTGCAGGAATATCCTCAATTCTCGGAGCAATTAATTTTATTTCTACCATTTTAAATATACATCATAAAAATATTACCCTAGATAAAATCCCTCTTTTAGTATGGTCAATCCTAATCACAGCAATCCTCCTTCTTTTAGCACTCCCTGTTCTAGCTGGAGCTATTACCATGTTACTAACAGATCGTAATCTAAATACTTCTTTCTTCGATCCATCAGGGGGGGGAGACCCCATTCTATACCAACATTTATTTTGATTTTTTGGACATCCAGAAGTTTA'
	)

	weird_2_ccs	= build_ccs(x = weird_2_sequences,
							id = 'PACBB007-16', 
							order = 'hymenoptera')	


	weird_2_ccs = frame(weird_2_ccs)
	weird_2_ccs = adjust(weird_2_ccs)
	weird_2_ccs = consensus(weird_2_ccs)

	expect_equal(weird_2_ccs$consensus, expected_consensus2)


###########################################3
# test of weird set 3

expected_consensus3 ="ACTTTATATTTCATTTTTGGAATTTGAGCTGGGATAATCGGAGCCTCTATAAGAATAATTATTCGTATAGAATTAAGAGTTCCAGGAATAGTAATTGGAAATGATCAAATTTATAACTCAATTGTTACCTCACACGCCTTTGTAATAATTTTCTTCATAGTTATACCTTTAATATTAGGAGGGTTTGGAAACTGACTAGTGCCATTAATAATCTCCTCACCAGATATGGCTTTCCCACGATTAAATAATATAAGATTTTGGTTATTACCACCCTCAATCATTTTATTAATATATAGAAATATTTGTGGTAGAGGAAGAGGAACAGGATGAACAGTATACCCCCCCTTATCAATA"

weird_3_sequences=list(
	'GGTCAACCAATCATAAAGATATTGGAACTTTATATTTCATTTTTGGAATTTGAGCTGGGATAATCGGAGCCTCTATAAGAATAATTATTCGTATAGAATTAAGAGTTCCAGGAATAGTAATTGGAAATGATCAAATTTATAACTCAATTGTTACCTCACACGCCTTTGTAATAATTTTCTTCATAGTTATACCTTTAATATTAGGAGGGTTTGGAAACTGACTAGTGCCATTAATAATCTCCTCACCAGATATGGCTTTCCCACGATTAAATAATATAAGATTTTGGTTATTACCACCCTCAATCATTTTATTAATATATAGAAATATTTGTGGTAGAGGAAGAGGAACAGGATGAACAGTATACCCCCCCTTATCAATACAAATTAATCCTTCTATTGATTTTTCAATTTTTTCCTTACATATTGCAGGAATTTCCTCAATTCTTAGTTCAATCAATTTTATTTGTACAATTTTAAATATAAAATCAAATAAAATTTACTTTAAAAACATCTCCTTATTTTGCTGATCAATTTTCATCACAACTATTCTTTTACTACTATCATTACCAGTTTTAGCAGGGGGTCTGACAATATTATTAACAGACCGAAATTTAAACACATCATTCTTTAACCCCAATGGAGGGGGAGACCCAGTATTATACCAACACTTATTTTGATTTTTTGGACATCCAGAAGTTTAC',
	'AGTCAACAAATCATAAAGATATTGGAACTTTATATTTCATTTTTGGAATTTGAGCTGGGATAATCGGAGCCTCTATAAGAATAATTATTCGTATAGAATTAAGAGTTCCAGGAATAGTAATTGGAAATGATCAAACTTATAACTCAATTGTTACCTCACACGCCTTTGTAATAATTTTCTTCATAGTTATACCTTTAATATTAGGAGGGTTTGGAAACTGACTAGTGCCATTAATAATCTCCTCACCAGACTATGGCTTTCCCACGATTAAATAATATAAGATTTTGGTTATTACCACCCTCAATCATTTTATTAATATATAGAAATATTTGTGGTAGAGGAAGAGGAACAGGATGAACAGTATACCCCCCCTTATCAATACAAATTAATCCTTCTATTGATTTTTCAATTTTTTCCTTACATATTGCAGGAATTTCCTCAATTCTTAGTTCAATCAATTTTATTTGTACAATTTTAAATATAAAATCAAATAAAATTTACTTTAAAAACATCTCTTTATTTTGCTGATCAATTTTCATCACAACTATTCTTTTACTACTATCATTACCAGTTTTAGCAGGGGGTCTGACAATATTATTAACAGACCGAAATTTAAACACATCATTCTTTAACCCCAATGGAGGGGGAGACCCAGTATTATACCAACACTTATTTTGATTTTTTGGTCATCCAGAAGTTTA',
	'GTTCAACCAATCATAAAGATATTGGAACTTTATATTTCATTTTTGGAATTTGAGCTGGGATAATCGGAGCCTCTATAAGAATAATTATTCGTATAGAATTAAGAGTTCCAGGAATAGTAATTGGAAATGATCAAATTTATAACTCAATTGTTACCTCACACGCCTTTGTAATAATTTTCTTCATAGTTATACCTTTAATATTAGGAGGGTTTGGAAACTGACTAGTGCCATTAATAATCTCCTCACCAGATATGGCTTTCCCACGATTAAATAATATAAGATTTTGGTTATTACCACCCTCAATCATTTTATTAATATATAGAAATATTTGTGGTAGAGGAAGAGGAACAGGATGAACAGTATACCCCCCCTTATCAATACAAATTAATCCTTCTATTGATTTTTCAATTTTTTCCTTACATATTGCAGGAATTTCCTCAATTCTTAGTTCAATCAATTTTATTTGTACAATTTTAAATATAAAATCAAATAAAATTTACTTTAAAAACATCTCTTTATTTTGCTGATCAATTTTCATCACAACTATTCTTTTACTACTATCATTACCAGTTTTAGCAGGGGGTCTGACAATATTATTAACAGACCGAAATTTAAACACATCATTCTTTAACCCCAATGGAGAGGGAGACCCAGTATTATACCAACACTTATTTTGATTTTTTGGACACCCAGAAGTTTA'
	)

	weird_3_ccs	= build_ccs(x = weird_3_sequences,
							id = 'PACBB8695-16', 
							order = 'hymenoptera')	

	weird_3_ccs = frame(weird_3_ccs)
	weird_3_ccs = adjust(weird_3_ccs)
	weird_3_ccs = consensus(weird_3_ccs)

	expect_equal(weird_3_ccs$consensus, expected_consensus3)

#TODO -decide how to handle the following:
#this instance there are 3 condons worth of nt sequence missing, so 9bp.
#should this be allowed? i.e. permit indels if they come in groups of 3 or is 
#it better to be conservative and truncate early
#check some more lepidoptera to see if this is inherent problem with their model... 
# best solution may be to further constrain model size.

###########################################3
# test of weird set 4
#consensus should be:
	nucraw = 'TTTATTTTTGGAATTTGAGCTGGAATAGTAGGAACTTCCTTAAGATTATTAATTCGATTAGAATTAAGAACTATTAAAAATTTAATTGGAAACGATCAAATTTATAATGTAATTGTAACTGCTCATGCTTTTATTATAATTTTTTTTATAGTTATACCAATTTTAATTGGGGGATTTGGAAATTGATTAATTCCTATTATATTAGGAGCACCAGATATAGCTTTTCCACGAATAAACAATATAAGATTTTGAATATTGCCCCCTTCTTTATCTTTATTATTAATTAGAAGAATAGTTGAAACTGGGACTGGAACAGGATGAACAGTCTATCCTCCTCTATCTTCAGTAATCGCCCACACAGGTTCATCAGTTGATTTTTCTATTTTTTCTTTACATATTGCAGGAATTTCTTCTATTTTAGGAGCAATTAATTTTATTTCAACAATAATAAATATAAAAATTAAATTTTTAAAATTTAATCAAATTTCATTATTTATTTGATCTATTTTAATTACTACAATTTTATTATTATTATCATTACCAGTATTAGCCGGAGCTATTACTATATTATTAACAGATCGA'
	expected_consensus4 = 'ACATTATATTTTATTTTTGGAATTTGAGCTGGAATAGTAGGAACTTCCTTAAGATTATTAATTCGATTAGAATTAAGAACTATTAAAAATTTAATTGGAAACGATCAAATTTATAATGTAATTGTAACTGCTCATGCTTTTATTATAATTTTTTTTATAGTTATACCAATTTTAATTGGGGGATTTGGAAATTGATTAATTCCTATTATATTAGGAGCACCAGATATAGCTTTTCCACGAATAAACAATATAAGATTTTGAATATTGCCCCCTTCTTTATCTTTATTATTAATTAGAAGAATAGTTGAAACTGGGACTGGAACAGGATGAACAGTCTATCCTCCTCTATCTTCAGTAATCGCCCACACAGGTTCATCAGTTGATTTTTCTATTTTTTCTTTACATATTGCAGGAATTTCTTCTATTTTAGGAGCAATTAATTTTATTTCAACAATAATAAATATAAAAATTAAATTTTTAAAATTTAATCAAATTTCATTATTTATTTGATCTATTTTAATTACTACAATTTTATTATTATTATCATTACCAGTATTAGCCGGAGCTATTACTATATTATTAACAGATCGAAATTTAAATACATCATTTTTTGATCCTATAGGAGGAGGAGACCCAATTCTTTATCAACATTT'

	weird_4_sequences = list(
		'ATTCAACCAATCATAAAGATATTGGAACATTATATTTTATTTTTGGAATTTGAGCTGGAATAGTAGGAACTTCCTGAAGATTATTAATTCGATTAGAATTAAGAACTATTAAAAATTTAATTGGAAACGATCAAATTTATAATGTAATTGTAACTGCTCATGCTTTTATTATAATTTTTTTTATAGTTATACCAATTTTAATTGGGGGATTTGGAAATTGATTAATTCCTATTATATTAGGAGCACCAGATATAGCTTTTCCACGAATAAACAATATAAGATTTTGAATATTGCCCCCTTCTTTATCTTTATTATTAATTAGAAGAATAGTTGAAACTGGGACTGGAACAGGATGAACAGTCTATCCTCCTCTATCTTCAGTAATCGCCCACACAGGTTCATCAGTTGATTTTTCTATTTTTTCTTTACATATTGCAGGAATTTCTTCTATTTTAGGAGCAATTAATTTTATTTCAACAATAATAAATATAAAAATTAAATTTTTAAAATTTAATCAAATTTCATTATTTATTTGATCTATTTTAATTACTACAATTTTATTATTATTATCATTACCAGTATTAGCCGGAGCTATTACTATATTATTAACAGATCGAAATTTAAATACATCATTTTTTGATCCTATAGGAGGAGGAGACCCAATTCTTTATCAACATTTATTTTGATTTTTTGGTACATCCAGAAGTTTA',
		'GGTCAACAAATCATAAAGATATTGGAACATTATATTTTATTTTTGGAATTTGAGCTGGAATAGTAGGAACTTCCTTAAGATTACTAATTCGATTAGAATTAAGAACTATTAAAAATTTAATTGGAAACGATCAAATTTATAATGTAATTGTAACTGCTCATGCTTTTATTATAATTTTTTTTATAGTTATACCAATTTTAATTGGGGGATTTGGAAATTGATTAATTCCTATTATATTAGGAGCACCAGATATAGCTTTTCCACGAATAAACAATATAAGATTTTGAATATTGCCCCCTTCTTTATCTTTATTATTAATTAGAAGAATAGTTGAAACTGGGACTGGAACAGGATGAACAGTCTATCCTCCTCTATCTTCAGTAATCGCCCACACAGGTTCATCAGTTGATTTTTCTATTTTTTCTTTACATATTGCAGGAATTTCTTCTATTTTAGGAGCAATTAATTTTATTTCAACAATAATAAATATAAAAATTAAATTTTTAAAATTTAATCAAATTTCATTATTTATTTGATCTATTTTAATTACTACAATTTTATTATTATTATCATTACCAGTATTAGCCGGAGCTATTACTATATTATTAACAGATCGAAATTTAAATACATCATTTTTTGATCCTATAGGAGGAGGAGACCCAATTCTTTATCAACATTTATTTTGATTTTTTGGACATCCATGAAGTTT',
		'AGTCAACAAATCATAAAGATATTGGAACATTATATTTTATTTTTGGAATTTGAGCTGGAATAGTAGGAACTTCCTTAAGATTATTAATTCGATTAGAATTAAGAACTATTAAAAATTTAATTGGAAACGATCAAATTTATAATGTAATTGTAACTGCTCATGCTTTTATTATAATTTTTTTTATAGTTATACCAATTTTAATTGGGGGGATTTGGAAATTGATTAATTCCTATTATATTAGGAGCACCAGATATAGCTTTTCCACGAATAAACAATATAAGATTTTGAATATTGCCCCCTTCTTTATCTTTATTATTAATTAGAAGAATAGTTGAAACTGGGACTGGAACAGGATGAACAGTCTATCCTCCTCTATCTTCAGTAATCGCCCACACAGGTTCATCAGTTGATTTTTCTATTTTTTCTTTACATATTGCAGGAATTTCTTCTATTTTAGGAGCAATTAATTTTATTTCAACAATAATAAATATAAAAATTAAATTTTTAAAATTTAATCAAATTTCATTATTTATTTGATCTATTTTAATTACTACAATTTTATTATTATTATCATTACCAGTATTAGCCGGAGCTATTACTATATTATTAACAGATCGAAATTTAAATACATCATTTTTTGATCCTATAGGAGGAGGAGACCCAATTCTTTATCAACATTTATTTTGATTTTTTGGTACACCCTGAAGTTTA',
		'GGTCAACCAATCATAAAGATATTGGAACATTATATTTTATTTTTGGAGTTTGAGCTGGAATAGTAGGAACTTCCTTAAGATTATTAATTCGATTAGAATTAAGAACTATTAAAAATTTAATTGGAAACGATCAAATTTATAATGTAATTGTAACTGCTCATGCTTTTATTATAATTTTTTTTATAGTTATACCAATTTTAATTGGGGGATTTGGAAATTGATTAATTCCTATTATATTAGGAGCACCAGATATAGCTTTTCCACGAATAAACAATATAAGATTTTGAATATTGCCCCCTTCTTTATCTTTATTATTAATTAGAAGAATAGTTGAAACTGGGACTGGAACAGGATGAACAGTCTATCCTCCTCTATCTTCAGTAATCGCCCACACAGGTTCATCAGTTGATTTTTCTATTTTTTCTTTACATATTGCAGGAATTTCTTCTATTTTAGGAGCAATTAATTTTATTTCAACAATAATAAATATAAAAATTAAATTTTTAAAATTTAATCAAATTTCATTATTTATTTGATCTATTTTAATTACTACAATTTTATTATTATTATCATTACCAGTATTAGCCGGAGCTATTACTATATTATTAACAGATCGAAATTTAAATACATCATTTTTTGATCCTATAGGAGGAGGAGACCCAATTCTTTATCAACATTTATTTTGATTTTTTGGACATCCAGAAGTTTA'
		)

	weird_4_ccs	= build_ccs(x = weird_4_sequences,
							id = 'PACBB051-16', 
							order = 'diptera')	

	weird_4_ccs = frame(weird_4_ccs)
	weird_4_ccs = adjust(weird_4_ccs)
	weird_4_ccs = consensus(weird_4_ccs)

	#weird_4_ccs$consensus == expected_consensus4
	expect_equal(weird_4_ccs$consensus, expected_consensus4)


})



###########################################3
# # weird 3 test of assumptions
#                             nucraw =         'TTTGGAATTTGAGCTGGGATAATCGGAGCCTCTATAAGAATAATTATTCGTATAGAATTAAGAGTTCCAGGAATAGTAATTGGAAATGATCAAATTTATAACTCAATTGTTACCTCACACGCCTTTGTAATAATTTTCTTCATAGTTATACCTTTAATATTAGGAGGGTTTGGAAACTGACTAGTGCCATTAATAATCTCCTCACCAGA TATGGCTTTCCCACGATTAAATAATATAAGATTTTGGTTATTACCACCCTCAATCATTTTATTAATATATAGAAATATTTGTGGTAGAGGAAGAGGAACAGGATGAACAGTATACCCCCCCTTATCAA TA           CAAATTAATCCTTCTATTGA         TTTTTCAATTTTTTCCTTACATATTGCAGGAATTTCCTCAATTCTTAGTTCAATCAATTTTATTTGTACAATTTTAAATATAAAATCAAATAAAATTTACTTTAAAAACATCTCTTTATTTTGCTGATCAATTTTCATCACAACTATTCTTTTACTACTATCATTACCAGTTTTAGCAGGGGGTCTGACAATATTATTAACA'
#                               "ACTTTATATTTCATTTTTGGAATTTGAGCTGGGATAATCGGAGCCTCTATAAGAATAATTATTCGTATAGAATTAAGAGTTCCAGGAATAGTAATTGGAAATGATCAAATTTATAACTCAATTGTTACCTCACACGCCTTTGTAATAATTTTCTTCATAGTTATACCTTTAATATTAGGAGGGTTTGGAAACTGACTAGTGCCATTAATAATCTCCTCACCAGA TATGGCTTTCCCACGATTAAATAATATAAGATTTTGGTTATTACCACCCTCAATCATTTTATTAATATATAGAAATATTTGTGGTAGAGGAAGAGGAACAGGATGAACAGTATACCCCCCCTTATCAA NNNNNNNNNNN  CAAATTAATCCTTCTATTGA         TTTTTCAATTTTTTCCTTACATATTGCAGGAATTTCCTCAATTCTTAGTTCAATCAATTTTATTTGTACAATTTTAAATATAAAATCAAATAAAATTTACTTTAAAAACATCTCTTTATTTTGCTGATCAATTTTCATCACAACTATTCTTTTACTACTATCATTACCAGTTTTAGCAGGGGGTCTGACAATATTATTAACAGACCGAAATTTAAACACATCATTCTTTAACCCCAATGGAGGGGGAGACCCAGTATTATACCAACACTT T"
# weird_3_sequences = list(
# 	'GGTCAACCAATCATAAAGATATTGGAACTTTATATTTCATTTTTGGAATTTGAGCTGGGATAATCGGAGCCTCTATAAGAATAATTATTCGTATAGAATTAAGAGTTCCAGGAATAGTAATTGGAAATGATCAAATTTATAACTCAATTGTTACCTCACACGCCTTTGTAATAATTTTCTTCATAGTTATACCTTTAATATTAGGAGGGTTTGGAAACTGACTAGTGCCATTAATAATCTCCTCACCAGA TATGGCTTTCCCACGATTAAATAATATAAGATTTTGGTTATTACCACCCTCAATCATTTTATTAATATATAGAAATATTTGTGGTAGAGGAAGAGGAACAGGATGAACAGTATACCCCCCCTTATCAA TA           CAAATTAATCCTTCTATTGA         TTTTTCAATTTTTTCCTTACATATTGCAGGAATTTCCTCAATTCTTAGTTCAATCAATTTTATTTGTACAATTTTAAATATAAAATCAAATAAAATTTACTTTAAAAACATCTCCTTATTTTGCTGATCAATTTTCATCACAACTATTCTTTTACTACTATCATTACCAGTTTTAGCAGGGGGTCTGACAATATTATTAACAGACCGAAATTTAAACACATCATTCTTTAACCCCAATGGAGGGGGAGACCCAGTATTATACCAACACTTATTTTGATTTTTTGGACATCCAGAAGTTTAC',
# 	'AGTCAACAAATCATAAAGATATTGGAACTTTATATTTCATTTTTGGAATTTGAGCTGGGATAATCGGAGCCTCTATAAGAATAATTATTCGTATAGAATTAAGAGTTCCAGGAATAGTAATTGGAAATGATCAAACTTATAACTCAATTGTTACCTCACACGCCTTTGTAATAATTTTCTTCATAGTTATACCTTTAATATTAGGAGGGTTTGGAAACTGACTAGTGCCATTAATAATCTCCTCACCAGACTATGGCTTTCCCACGATTAAATAATATAAGATTTTGGTTATTACCACCCTCAATCATTTTATTAATATATAGAAATATTTGTGGTAGAGGAAGAGGAACAGGATGAACAGTATACCCCCCCTTATCAA TA           CAAATTAATCCTTCTATTGA         TTTTTCAATTTTTTCCTTACATATTGCAGGAATTTCCTCAATTCTTAGTTCAATCAATTTTATTTGTACAATTTTAAATATAAAATCAAATAAAATTTACTTTAAAAACATCTCTTTATTTTGCTGATCAATTTTCATCACAACTATTCTTTTACTACTATCATTACCAGTTTTAGCAGGGGGTCTGACAATATTATTAACAGACCGAAATTTAAACACATCATTCTTTAACCCCAATGGAGGGGGAGACCCAGTATTATACCAACACTTATTTTGATTTTTTGGTCATCCAGAAGTTTA',
# 	'GTTCAACCAATCATAAAGATATTGGAACTTTATATTTCATTTTTGGAATTTGAGCTGGGATAATCGGAGCCTCTATAAGAATAATTATTCGTATAGAATTAAGAGTTCCAGGAATAGTAATTGGAAATGATCAAATTTATAACTCAATTGTTACCTCACACGCCTTTGTAATAATTTTCTTCATAGTTATACCTTTAATATTAGGAGGGTTTGGAAACTGACTAGTGCCATTAATAATCTCCTCACCAGA TATGGCTTTCCCACGATTAAATAATATAAGATTTTGGTTATTACCACCCTCAATCATTTTATTAATATATAGAAATATTTGTGGTAGAGGAAGAGGAACAGGATGAACAGTATACCCCCCCTTATCAA TA           CAAATTAATCCTTCTATTGA         TTTTTCAATTTTTTCCTTACATATTGCAGGAATTTCCTCAATTCTTAGTTCAATCAATTTTATTTGTACAATTTTAAATATAAAATCAAATAAAATTTACTTTAAAAACATCTCTTTATTTTGCTGATCAATTTTCATCACAACTATTCTTTTACTACTATCATTACCAGTTTTAGCAGGGGGTCTGACAATATTATTAACAGACCGAAATTTAAACACATCATTCTTTAACCCCAATGGAGAGGGAGACCCAGTATTATACCAACACTTATTTTGATTTTTTGGACACCCAGAAGTTTA'
# 	)
# 
# #Above the sequences are aligned to on another 
# #second string is the consensus output- note that there appear to be a few erNNNNNNNNNNNrors
# #are these legitimate corrections or is there an error in the correction algorithm.
# #have a look at the paths and the adjusted sequences and try to find where the prblem lies
# 
# #translate the sequences and see what they appear like in the amino acid space.
# library(coi5p)
# test1 = "ACTTTATATTTCATTTTTGGAATTTGAGCTGGGATAATCGGAGCCTCTATAAGAATAATTATTCGTATAGAATTAAGAGTTCCAGGAATAGTAATTGGAAATGATCAAATTTATAACTCAATTGTTACCTCACACGCCTTTGTAATAATTTTCTTCATAGTTATACCTTTAATATTAGGAGGGTTTGGAAACTGACTAGTGCCATTAATAATCTCCTCACCAGATATGGCTTTCCCACGATTAAATAATATAAGATTTTGGTTATTACCACCCTCAATCATTTTATTAATATATAGAAATATTTGTGGTAGAGGAAGAGGAACAGGATGAACAGTATACCCCCCCTTATCAANNNNNNNNNNNCAAATTAATCCTTCTATTGATTTTTCAATTTTTTCCTTACATATTGCAGGAATTTCCTCAATTCTTAGTTCAATCAATTTTATTTGTACAATTTTAAATATAAAATCAAATAAAATTTACTTTAAAAACATCTCTTTATTTTGCTGATCAATTTTCATCACAACTATTCTTTTACTACTATCATTACCAGTTTTAGCAGGGGGTCTGACAATATTATTAACAGACCGAAATTTAAACACATCATTCTTTAACCCCAATGGAGGGGGAGACCCAGTATTATACCAACACTTT"
# test1_framecheck = coi5p_pipe(test1, trans_table = which_trans_table('Hymenoptera'))
# test1_framecheck
# 
# #the data appear to be valid - just need to correct the issue regarding the 
# ccc_weird_read1 = 'GGTCAACCAATCATAAAGATATTGGAACTTTATATTTCATTTTTGGAATTTGAGCTGGGATAATCGGAGCCTCTATAAGAATAATTATTCGTATAGAATTAAGAGTTCCAGGAATAGTAATTGGAAATGATCAAATTTATAACTCAATTGTTACCTCACACGCCTTTGTAATAATTTTCTTCATAGTTATACCTTTAATATTAGGAGGGTTTGGAAACTGACTAGTGCCATTAATAATCTCCTCACCAGATATGGCTTTCCCACGATTAAATAATATAAGATTTTGGTTATTACCACCCTCAATCATTTTATTAATATATAGAAATATTTGTGGTAGAGGAAGAGGAACAGGATGAACAGTATACCCCCCCTTATCAATACAAATTAATCCTTCTATTGATTTTTCAATTTTTTCCTTACATATTGCAGGAATTTCCTCAATTCTTAGTTCAATCAATTTTATTTGTACAATTTTAAATATAAAATCAAATAAAATTTACTTTAAAAACATCTCCTTATTTTGCTGATCAATTTTCATCACAACTATTCTTTTACTACTATCATTACCAGTTTTAGCAGGGGGTCTGACAATATTATTAACAGACCGAAATTTAAACACATCATTCTTTAACCCCAATGGAGGGGGAGACCCAGTATTATACCAACACTTATTTTGATTTTTTGGACATCCAGAAGTTTAC'
# test1a_framecheck = coi5p_pipe(ccc_weird_read1, trans_table = which_trans_table('Hymenoptera'))
# test1a_framecheck
# 
# #the sequences as they sit are in reading frame... so there is no real issue that the phmm is picking up on... just a bad set of inserted placeholders.
# 
# nucraw_weird3 ='TTTGGAATTTGAGCTGGGATAATCGGAGCCTCTATAAGAATAATTATTCGTATAGAATTAAGAGTTCCAGGAATAGTAATTGGAAATGATCAAATTTATAACTCAATTGTTACCTCACACGCCTTTGTAATAATTTTCTTCATAGTTATACCTTTAATATTAGGAGGGTTTGGAAACTGACTAGTGCCATTAATAATCTCCTCACCAGATATGGCTTTCCCACGATTAAATAATATAAGATTTTGGTTATTACCACCCTCAATCATTTTATTAATATATAGAAATATTTGTGGTAGAGGAAGAGGAACAGGATGAACAGTATACCCCCCCTTATCAATACAAATTAATCCTTCTATTGATTTTTCAATTTTTTCCTTACATATTGCAGGAATTTCCTCAATTCTTAGTTCAATCAATTTTATTTGTACAATTTTAAATATAAAATCAAATAAAATTTACTTTAAAAACATCTCTTTATTTTGCTGATCAATTTTCATCACAACTATTCTTTTACTACTATCATTACCAGTTTTAGCAGGGGGTCTGACAATATTATTAACA'
# test1b_framecheck = coi5p_pipe(nucraw_weird3, trans_table = which_trans_table('Hymenoptera'))
# test1b_framecheck
# 
# "TLYFIFGIWAGMIGASMSMIIRMELSVPGMVIGNDQIYNSIVTSHAFVMIFFMVMPLMLGGFGNWLVPLMISSPDMAFPRLNNMSFWLLPPSIILLMYSNICGSGSGTGWTVYPPLS----QINPSIDFSIFSLHIAGISSILSSINFICTILNMKSNKIYFKNISLFCWSIFITTILLLLSLPVLAGGLTMLLTDRNLNTSFFNPNGGGDPVLYQHF"
# "TLYFIFGIWAGMIGASMSMIIRMELSVPGMVIGNDQIYNSIVTSHAFVMIFFMVMPLMLGGFGNWLVPLMISSPDMAFPRLNNMSFWLLPPSIILLMYSNICGSGSGTGWTVYPPLSMQINPSIDFSIFSLHIAGISSILSSINFICTILNMKSNKIYFKNISLFCWSIFITTILLLLSLPVLAGGLTMLLTDRNLNTSFFNPNGGGDPVLYQHL"
# "-----FGIWAGMIGASMSMIIRMELSVPGMVIGNDQIYNSIVTSHAFVMIFFMVMPLMLGGFGNWLVPLMISSPDMAFPRLNNMSFWLLPPSIILLMYSNICGSGSGTGWTVYPPLSMQINPSIDFSIFSLHIAGISSILSSINFICTILNMKSNKIYFKNISLFCWSIFITTILLLLSLPVLAGGLTMLL"
# #ISSUES TO RESOLVE 
# # 1.- why are there NNNNNNNNNNN in the consensus sequence?
# # answer - this should be the end!
# #This is the recycling of the sequence in a loop. NNNNNNNN should be the conclusion of the consensus, but the adjust_seq
# # function is recycling the base pairs of the sequence as opposed to stopping when the end is reached. need to fix the looping conditions
# # ^see test_indelsCorrection.r test2 where this is being worked on.
# 
# # 2. why is the last base pair changed? need to fix this.
# 
# # 3. the nucraw trims 15bp from the front and 72 from the back... why and is this necessary?
# 
