test_that("Sequences are translated and checked for amino acids correctly.", {

  #PACBB051-16
	#------------------------------------------------TTTATTTTTGGAATTTGAGCTGGAATAGTAGGAACTTCCTTA---AGATTATTAATTCGATTAGAATTAAGAACTATTAAAAATTTAATTGGAAAC---GATCAAATTTATAATGTAATTGTAACTGCTCATGCTTTTATTATAATTTTTTTTATAGTTATACCAATTTTAATTGGGGGATTTGGAAATTGATTAATTCCTATTATA---TTAGGAGCACCAGATATAGCTTTTCCACGAATAAACAATATAAGATTTTGAATATTGCCCCCTTCTTTATCTTTATTATTAATTAGAAGAATAGTTGAAACTGGGACTGGAACAGGATGAACAGTCTATCCTCCTCTATCTTCAGTAATCGCCCACACAGGTTCATCAGTTGATTTTTCT---ATTTTTTCTTTACATATTGCAGGAATTTCTTCTATTTTAGGAGCAATTAATTTTATTTCAACAATAATAAATATAAAAATTAAATTTTTAAAATTTAATCAAATTTCATTATTTATTTGATCTATTTTAATTACTACAATTTTATTATTATTATCATTACCAGTATTAGCCGGA---GCTATTACTATATTATTAACAGATCGA----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
	#----------------FIFGIWAGMVGTSL-SLLIRLELSTIKNLIGN-DQIYNVIVTAHAFIMIFFMVMPILIGGFGNWLIPIM-LGAPDMAFPRMNNMSFWMLPPSLSLLLISSMVETGTGTGWTVYPPLSSVIAHTGSSVDFS-IFSLHIAGISSILGAINFISTMMNMKIKFLKFNQISLFIWSILITTILLLLSLPVLAG-AITMLLTDR---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

	nucraw = 'TTTATTTTTGGAATTTGAGCTGGAATAGTAGGAACTTCCTTAAGATTATTAATTCGATTAGAATTAAGAACTATTAAAAATTTAATTGGAAACGATCAAATTTATAATGTAATTGTAACTGCTCATGCTTTTATTATAATTTTTTTTATAGTTATACCAATTTTAATTGGGGGATTTGGAAATTGATTAATTCCTATTATATTAGGAGCACCAGATATAGCTTTTCCACGAATAAACAATATAAGATTTTGAATATTGCCCCCTTCTTTATCTTTATTATTAATTAGAAGAATAGTTGAAACTGGGACTGGAACAGGATGAACAGTCTATCCTCCTCTATCTTCAGTAATCGCCCACACAGGTTCATCAGTTGATTTTTCTATTTTTTCTTTACATATTGCAGGAATTTCTTCTATTTTAGGAGCAATTAATTTTATTTCAACAATAATAAATATAAAAATTAAATTTTTAAAATTTAATCAAATTTCATTATTTATTTGATCTATTTTAATTACTACAATTTTATTATTATTATCATTACCAGTATTAGCCGGAGCTATTACTATATTATTAACAGATCGA'
	expected_consensus = 'ACATTATATTTTATTTTTGGAATTTGAGCTGGAATAGTAGGAACTTCCTTAAGATTATTAATTCGATTAGAATTAAGAACTATTAAAAATTTAATTGGAAACGATCAAATTTATAATGTAATTGTAACTGCTCATGCTTTTATTATAATTTTTTTTATAGTTATACCAATTTTAATTGGGGGATTTGGAAATTGATTAATTCCTATTATATTAGGAGCACCAGATATAGCTTTTCCACGAATAAACAATATAAGATTTTGAATATTGCCCCCTTCTTTATCTTTATTATTAATTAGAAGAATAGTTGAAACTGGGACTGGAACAGGATGAACAGTCTATCCTCCTCTATCTTCAGTAATCGCCCACACAGGTTCATCAGTTGATTTTTCTATTTTTTCTTTACATATTGCAGGAATTTCTTCTATTTTAGGAGCAATTAATTTTATTTCAACAATAATAAATATAAAAATTAAATTTTTAAAATTTAATCAAATTTCATTATTTATTTGATCTATTTTAATTACTACAATTTTATTATTATTATCATTACCAGTATTAGCCGGAGCTATTACTATATTATTAACAGATCGAAATTTAAATACATCATTTTTTGATCCTATAGGAGGAGGAGACCCAATTCTTTATCAACATTT'

	trans_sequences = list(
		'ATTCAACCAATCATAAAGATATTGGAACATTATATTTTATTTTTGGAATTTGAGCTGGAATAGTAGGAACTTCCTGAAGATTATTAATTCGATTAGAATTAAGAACTATTAAAAATTTAATTGGAAACGATCAAATTTATAATGTAATTGTAACTGCTCATGCTTTTATTATAATTTTTTTTATAGTTATACCAATTTTAATTGGGGGATTTGGAAATTGATTAATTCCTATTATATTAGGAGCACCAGATATAGCTTTTCCACGAATAAACAATATAAGATTTTGAATATTGCCCCCTTCTTTATCTTTATTATTAATTAGAAGAATAGTTGAAACTGGGACTGGAACAGGATGAACAGTCTATCCTCCTCTATCTTCAGTAATCGCCCACACAGGTTCATCAGTTGATTTTTCTATTTTTTCTTTACATATTGCAGGAATTTCTTCTATTTTAGGAGCAATTAATTTTATTTCAACAATAATAAATATAAAAATTAAATTTTTAAAATTTAATCAAATTTCATTATTTATTTGATCTATTTTAATTACTACAATTTTATTATTATTATCATTACCAGTATTAGCCGGAGCTATTACTATATTATTAACAGATCGAAATTTAAATACATCATTTTTTGATCCTATAGGAGGAGGAGACCCAATTCTTTATCAACATTTATTTTGATTTTTTGGTACATCCAGAAGTTTA',
		'GGTCAACAAATCATAAAGATATTGGAACATTATATTTTATTTTTGGAATTTGAGCTGGAATAGTAGGAACTTCCTTAAGATTACTAATTCGATTAGAATTAAGAACTATTAAAAATTTAATTGGAAACGATCAAATTTATAATGTAATTGTAACTGCTCATGCTTTTATTATAATTTTTTTTATAGTTATACCAATTTTAATTGGGGGATTTGGAAATTGATTAATTCCTATTATATTAGGAGCACCAGATATAGCTTTTCCACGAATAAACAATATAAGATTTTGAATATTGCCCCCTTCTTTATCTTTATTATTAATTAGAAGAATAGTTGAAACTGGGACTGGAACAGGATGAACAGTCTATCCTCCTCTATCTTCAGTAATCGCCCACACAGGTTCATCAGTTGATTTTTCTATTTTTTCTTTACATATTGCAGGAATTTCTTCTATTTTAGGAGCAATTAATTTTATTTCAACAATAATAAATATAAAAATTAAATTTTTAAAATTTAATCAAATTTCATTATTTATTTGATCTATTTTAATTACTACAATTTTATTATTATTATCATTACCAGTATTAGCCGGAGCTATTACTATATTATTAACAGATCGAAATTTAAATACATCATTTTTTGATCCTATAGGAGGAGGAGACCCAATTCTTTATCAACATTTATTTTGATTTTTTGGACATCCATGAAGTTT',
		'AGTCAACAAATCATAAAGATATTGGAACATTATATTTTATTTTTGGAATTTGAGCTGGAATAGTAGGAACTTCCTTAAGATTATTAATTCGATTAGAATTAAGAACTATTAAAAATTTAATTGGAAACGATCAAATTTATAATGTAATTGTAACTGCTCATGCTTTTATTATAATTTTTTTTATAGTTATACCAATTTTAATTGGGGGGATTTGGAAATTGATTAATTCCTATTATATTAGGAGCACCAGATATAGCTTTTCCACGAATAAACAATATAAGATTTTGAATATTGCCCCCTTCTTTATCTTTATTATTAATTAGAAGAATAGTTGAAACTGGGACTGGAACAGGATGAACAGTCTATCCTCCTCTATCTTCAGTAATCGCCCACACAGGTTCATCAGTTGATTTTTCTATTTTTTCTTTACATATTGCAGGAATTTCTTCTATTTTAGGAGCAATTAATTTTATTTCAACAATAATAAATATAAAAATTAAATTTTTAAAATTTAATCAAATTTCATTATTTATTTGATCTATTTTAATTACTACAATTTTATTATTATTATCATTACCAGTATTAGCCGGAGCTATTACTATATTATTAACAGATCGAAATTTAAATACATCATTTTTTGATCCTATAGGAGGAGGAGACCCAATTCTTTATCAACATTTATTTTGATTTTTTGGTACACCCTGAAGTTTA',
		'GGTCAACCAATCATAAAGATATTGGAACATTATATTTTATTTTTGGAGTTTGAGCTGGAATAGTAGGAACTTCCTTAAGATTATTAATTCGATTAGAATTAAGAACTATTAAAAATTTAATTGGAAACGATCAAATTTATAATGTAATTGTAACTGCTCATGCTTTTATTATAATTTTTTTTATAGTTATACCAATTTTAATTGGGGGATTTGGAAATTGATTAATTCCTATTATATTAGGAGCACCAGATATAGCTTTTCCACGAATAAACAATATAAGATTTTGAATATTGCCCCCTTCTTTATCTTTATTATTAATTAGAAGAATAGTTGAAACTGGGACTGGAACAGGATGAACAGTCTATCCTCCTCTATCTTCAGTAATCGCCCACACAGGTTCATCAGTTGATTTTTCTATTTTTTCTTTACATATTGCAGGAATTTCTTCTATTTTAGGAGCAATTAATTTTATTTCAACAATAATAAATATAAAAATTAAATTTTTAAAATTTAATCAAATTTCATTATTTATTTGATCTATTTTAATTACTACAATTTTATTATTATTATCATTACCAGTATTAGCCGGAGCTATTACTATATTATTAACAGATCGAAATTTAAATACATCATTTTTTGATCCTATAGGAGGAGGAGACCCAATTCTTTATCAACATTTATTTTGATTTTTTGGACATCCAGAAGTTTA'
		)

	
	trans_denoise	= mapply(denoise, trans_sequences, to_file = FALSE)	
	
	
	#trans_ccs$consensus == expected_consensus
	
	#expect_equal(trans_ccs$consensus, expected_consensus)
	#expect_equal(trans_ccs$stop_codons, FALSE)

	expect_equal(1,1)	
})

